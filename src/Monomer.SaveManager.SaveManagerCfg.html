<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Monomer.SaveManager.SaveManagerCfg</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Configuration</span></span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#Saves"><span class="hs-identifier">Saves</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier">SaveManagerCfg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#onSavesChange"><span class="hs-identifier">onSavesChange</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#onSavesChangeReq"><span class="hs-identifier">onSavesChangeReq</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#captionMethod"><span class="hs-identifier">captionMethod</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm"><span class="hs-identifier">noConfirm</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm_"><span class="hs-identifier">noConfirm_</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.LocalTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ZonedTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Core</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Core.Combinators</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">type</span><span> </span><span id="Saves"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#Saves"><span class="hs-identifier hs-var">Saves</span></a></span></span><span> </span><span id="local-6989586621679172688"><span class="annot"><a href="#local-6989586621679172688"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679172688"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">{-|
Configuration options for saveManager:

- 'onFocus': event to raise when focus is received.
- 'onFocusReq': 'WidgetRequest' to generate when focus is received.
- 'onBlur': event to raise when focus is lost.
- 'onBlurReq': 'WidgetRequest' to generate when focus is lost.
- 'onChange': event to raise when the value changes.
- 'onChangeReq': 'WidgetRequest' to generate when the value changes.
- 'onSavesChange': event to raise when the saves change.
- 'onSavesChangeReq': 'WidgetRequest' to generate when the saves change.
- 'captionMethod': function to generate the caption for the slot.
- 'noConfirm': don't show confirmation dialog.
-}</span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="SaveManagerCfg"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-var">SaveManagerCfg</span></a></span></span><span> </span><span id="local-6989586621679172848"><span class="annot"><a href="#local-6989586621679172848"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679172847"><span class="annot"><a href="#local-6989586621679172847"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679172846"><span class="annot"><a href="#local-6989586621679172846"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SaveManagerCfg"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-var">SaveManagerCfg</span></a></span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="_smcOnFocusReq"><span class="annot"><span class="annottext">forall s e a. SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var hs-var">_smcOnFocusReq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetRequest</span></span><span> </span><span class="annot"><a href="#local-6989586621679172848"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172847"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_smcOnBlurReq"><span class="annot"><span class="annottext">forall s e a. SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var hs-var">_smcOnBlurReq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetRequest</span></span><span> </span><span class="annot"><a href="#local-6989586621679172848"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172847"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_smcOnChangeReq"><span class="annot"><span class="annottext">forall s e a. SaveManagerCfg s e a -&gt; [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var hs-var">_smcOnChangeReq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679172846"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetRequest</span></span><span> </span><span class="annot"><a href="#local-6989586621679172848"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172847"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_smcOnSavesChangeReq"><span class="annot"><span class="annottext">forall s e a.
SaveManagerCfg s e a -&gt; [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var hs-var">_smcOnSavesChangeReq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#Saves"><span class="hs-identifier hs-type">Saves</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172846"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetRequest</span></span><span> </span><span class="annot"><a href="#local-6989586621679172848"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172847"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_smcCaptionMethod"><span class="annot"><span class="annottext">forall s e a.
SaveManagerCfg s e a -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcCaptionMethod"><span class="hs-identifier hs-var hs-var">_smcCaptionMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679172846"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ZonedTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_smcNoConfirm"><span class="annot"><span class="annottext">forall s e a. SaveManagerCfg s e a -&gt; Maybe Bool
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcNoConfirm"><span class="hs-identifier hs-var hs-var">_smcNoConfirm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span id="local-6989586621679172815"><span id="local-6989586621679172816"><span id="local-6989586621679172817"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172817"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172816"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172815"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679172677"><span class="annot"><span class="annottext">def :: SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg :: forall s e a.
[Path -&gt; WidgetRequest s e]
-&gt; [Path -&gt; WidgetRequest s e]
-&gt; [a -&gt; WidgetRequest s e]
-&gt; [Saves a -&gt; WidgetRequest s e]
-&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
-&gt; Maybe Bool
-&gt; SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span>
</span><span id="line-50"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnFocusReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var">_smcOnFocusReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcOnBlurReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var">_smcOnBlurReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcOnChangeReq :: [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var">_smcOnChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-53"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcOnSavesChangeReq :: [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var">_smcOnSavesChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcCaptionMethod :: Maybe (a -&gt; ZonedTime -&gt; Text)
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcCaptionMethod"><span class="hs-identifier hs-var">_smcCaptionMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a -&gt; ZonedTime -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-55"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcNoConfirm :: Maybe Bool
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcNoConfirm"><span class="hs-identifier hs-var">_smcNoConfirm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-56"></span><span>        </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span id="local-6989586621679172808"><span id="local-6989586621679172809"><span id="local-6989586621679172810"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679172671"><span id="local-6989586621679172673"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172810"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172809"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679172660"><span class="annot"><span class="annottext">&lt;&gt; :: SaveManagerCfg s e a
-&gt; SaveManagerCfg s e a -&gt; SaveManagerCfg s e a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span id="local-6989586621679172659"><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span id="local-6989586621679172658"><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg Any Any Any
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-60"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnFocusReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var">_smcOnFocusReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
forall s e a. SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var hs-var">_smcOnFocusReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Path -&gt; WidgetRequest s e]
-&gt; [Path -&gt; WidgetRequest s e] -&gt; [Path -&gt; WidgetRequest s e]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
forall s e a. SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var hs-var">_smcOnFocusReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-61"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcOnBlurReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var">_smcOnBlurReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
forall s e a. SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var hs-var">_smcOnBlurReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Path -&gt; WidgetRequest s e]
-&gt; [Path -&gt; WidgetRequest s e] -&gt; [Path -&gt; WidgetRequest s e]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
forall s e a. SaveManagerCfg s e a -&gt; [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var hs-var">_smcOnBlurReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-62"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcOnChangeReq :: [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var">_smcOnChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [a -&gt; WidgetRequest s e]
forall s e a. SaveManagerCfg s e a -&gt; [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var hs-var">_smcOnChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; WidgetRequest s e]
-&gt; [a -&gt; WidgetRequest s e] -&gt; [a -&gt; WidgetRequest s e]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [a -&gt; WidgetRequest s e]
forall s e a. SaveManagerCfg s e a -&gt; [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var hs-var">_smcOnChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-63"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcOnSavesChangeReq :: [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var">_smcOnSavesChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [Saves a -&gt; WidgetRequest s e]
forall s e a.
SaveManagerCfg s e a -&gt; [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var hs-var">_smcOnSavesChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Saves a -&gt; WidgetRequest s e]
-&gt; [Saves a -&gt; WidgetRequest s e] -&gt; [Saves a -&gt; WidgetRequest s e]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; [Saves a -&gt; WidgetRequest s e]
forall s e a.
SaveManagerCfg s e a -&gt; [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var hs-var">_smcOnSavesChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcCaptionMethod :: Maybe (a -&gt; ZonedTime -&gt; Text)
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcCaptionMethod"><span class="hs-identifier hs-var">_smcCaptionMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-66"></span><span>            </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
forall s e a.
SaveManagerCfg s e a -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcCaptionMethod"><span class="hs-identifier hs-var hs-var">_smcCaptionMethod</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (a -&gt; ZonedTime -&gt; Text)
-&gt; Maybe (a -&gt; ZonedTime -&gt; Text) -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
forall s e a.
SaveManagerCfg s e a -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcCaptionMethod"><span class="hs-identifier hs-var hs-var">_smcCaptionMethod</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-67"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_smcNoConfirm :: Maybe Bool
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcNoConfirm"><span class="hs-identifier hs-var">_smcNoConfirm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; Maybe Bool
forall s e a. SaveManagerCfg s e a -&gt; Maybe Bool
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcNoConfirm"><span class="hs-identifier hs-var hs-var">_smcNoConfirm</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172658"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Maybe Bool
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a -&gt; Maybe Bool
forall s e a. SaveManagerCfg s e a -&gt; Maybe Bool
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcNoConfirm"><span class="hs-identifier hs-var hs-var">_smcNoConfirm</span></a></span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
</span><a href="#local-6989586621679172659"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621679172800"><span id="local-6989586621679172801"><span id="local-6989586621679172802"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679172651"><span id="local-6989586621679172653"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172802"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172801"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172800"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679172648"><span class="annot"><span class="annottext">mempty :: SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span></span></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621679172789"><span id="local-6989586621679172790"><span id="local-6989586621679172791"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679172791"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CmbOnFocus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172790"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172791"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679172791"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621679172641"><span class="annot"><span class="annottext">onFocus :: (Path -&gt; e) -&gt; SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">onFocus</span></span></span><span> </span><span id="local-6989586621679172639"><span class="annot"><span class="annottext">Path -&gt; e
</span><a href="#local-6989586621679172639"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-76"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnFocusReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var">_smcOnFocusReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">e -&gt; WidgetRequest s e
forall s e. WidgetEvent e =&gt; e -&gt; WidgetRequest s e
</span><span class="hs-identifier hs-var">RaiseEvent</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; WidgetRequest s e)
-&gt; (Path -&gt; e) -&gt; Path -&gt; WidgetRequest s e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Path -&gt; e
</span><a href="#local-6989586621679172639"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span>            </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679172773"><span id="local-6989586621679172774"><span id="local-6989586621679172775"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CmbOnFocusReq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172775"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172774"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172773"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679172775"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172774"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679172632"><span class="annot"><span class="annottext">onFocusReq :: (Path -&gt; WidgetRequest s e) -&gt; SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">onFocusReq</span></span></span><span> </span><span id="local-6989586621679172630"><span class="annot"><span class="annottext">Path -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172630"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-81"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnFocusReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnFocusReq"><span class="hs-identifier hs-var">_smcOnFocusReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Path -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172630"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="local-6989586621679172763"><span id="local-6989586621679172764"><span id="local-6989586621679172765"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679172765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CmbOnBlur</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172764"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679172765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679172623"><span class="annot"><span class="annottext">onBlur :: (Path -&gt; e) -&gt; SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">onBlur</span></span></span><span> </span><span id="local-6989586621679172621"><span class="annot"><span class="annottext">Path -&gt; e
</span><a href="#local-6989586621679172621"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-87"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnBlurReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var">_smcOnBlurReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">e -&gt; WidgetRequest s e
forall s e. WidgetEvent e =&gt; e -&gt; WidgetRequest s e
</span><span class="hs-identifier hs-var">RaiseEvent</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; WidgetRequest s e)
-&gt; (Path -&gt; e) -&gt; Path -&gt; WidgetRequest s e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Path -&gt; e
</span><a href="#local-6989586621679172621"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>            </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621679172752"><span id="local-6989586621679172753"><span id="local-6989586621679172754"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CmbOnBlurReq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172753"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172752"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679172754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172753"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621679172616"><span class="annot"><span class="annottext">onBlurReq :: (Path -&gt; WidgetRequest s e) -&gt; SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">onBlurReq</span></span></span><span> </span><span id="local-6989586621679172614"><span class="annot"><span class="annottext">Path -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172614"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnBlurReq :: [Path -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnBlurReq"><span class="hs-identifier hs-var">_smcOnBlurReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Path -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172614"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621679172742"><span id="local-6989586621679172743"><span id="local-6989586621679172744"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679172744"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CmbOnChange</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172743"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172744"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679172742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172744"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621679172607"><span class="annot"><span class="annottext">onChange :: (a -&gt; e) -&gt; SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">onChange</span></span></span><span> </span><span id="local-6989586621679172605"><span class="annot"><span class="annottext">a -&gt; e
</span><a href="#local-6989586621679172605"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-98"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnChangeReq :: [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var">_smcOnChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">e -&gt; WidgetRequest s e
forall s e. WidgetEvent e =&gt; e -&gt; WidgetRequest s e
</span><span class="hs-identifier hs-var">RaiseEvent</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; WidgetRequest s e) -&gt; (a -&gt; e) -&gt; a -&gt; WidgetRequest s e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; e
</span><a href="#local-6989586621679172605"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679172731"><span id="local-6989586621679172732"><span id="local-6989586621679172733"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CmbOnChangeReq</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172732"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172731"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679172733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172732"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172731"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>        </span><span id="local-6989586621679172600"><span class="annot"><span class="annottext">onChangeReq :: (a -&gt; WidgetRequest s e) -&gt; SaveManagerCfg s e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">onChangeReq</span></span></span><span> </span><span id="local-6989586621679172598"><span class="annot"><span class="annottext">a -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172598"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-104"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnChangeReq :: [a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnChangeReq"><span class="hs-identifier hs-var">_smcOnChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172598"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">{-|
On saves change event.
-}</span><span>
</span><span id="line-110"></span><span id="local-6989586621679172728"><span id="local-6989586621679172729"><span id="local-6989586621679172730"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#onSavesChange"><span class="hs-identifier hs-type">onSavesChange</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679172730"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#Saves"><span class="hs-identifier hs-type">Saves</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679172730"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172728"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172730"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172729"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-114"></span><span id="onSavesChange"><span class="annot"><span class="annottext">onSavesChange :: forall e a s.
WidgetEvent e =&gt;
(Saves a -&gt; e) -&gt; SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#onSavesChange"><span class="hs-identifier hs-var hs-var">onSavesChange</span></a></span></span><span> </span><span id="local-6989586621679172594"><span class="annot"><span class="annottext">Saves a -&gt; e
</span><a href="#local-6989586621679172594"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnSavesChangeReq :: [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var">_smcOnSavesChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">e -&gt; WidgetRequest s e
forall s e. WidgetEvent e =&gt; e -&gt; WidgetRequest s e
</span><span class="hs-identifier hs-var">RaiseEvent</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; WidgetRequest s e)
-&gt; (Saves a -&gt; e) -&gt; Saves a -&gt; WidgetRequest s e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Saves a -&gt; e
</span><a href="#local-6989586621679172594"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">{-|
On saves change 'WidgetRequest'.
-}</span><span>
</span><span id="line-121"></span><span id="local-6989586621679172722"><span id="local-6989586621679172723"><span id="local-6989586621679172724"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#onSavesChangeReq"><span class="hs-identifier hs-type">onSavesChangeReq</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#Saves"><span class="hs-identifier hs-type">Saves</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172724"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetRequest</span></span><span> </span><span class="annot"><a href="#local-6989586621679172723"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172722"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172723"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172722"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172724"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-124"></span><span id="onSavesChangeReq"><span class="annot"><span class="annottext">onSavesChangeReq :: forall a s e.
(Saves a -&gt; WidgetRequest s e) -&gt; SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#onSavesChangeReq"><span class="hs-identifier hs-var hs-var">onSavesChangeReq</span></a></span></span><span> </span><span id="local-6989586621679172592"><span class="annot"><span class="annottext">Saves a -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172592"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcOnSavesChangeReq :: [Saves a -&gt; WidgetRequest s e]
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcOnSavesChangeReq"><span class="hs-identifier hs-var">_smcOnSavesChangeReq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Saves a -&gt; WidgetRequest s e
</span><a href="#local-6989586621679172592"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">{-|
Receives function which converts the value and current time into
text and uses it to generate the caption for the slot. Should be
used to show more information than just modification time about the
stored value.
-}</span><span>
</span><span id="line-134"></span><span id="local-6989586621679172716"><span id="local-6989586621679172717"><span id="local-6989586621679172718"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#captionMethod"><span class="hs-identifier hs-type">captionMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679172718"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ZonedTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172717"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172716"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172718"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-135"></span><span id="captionMethod"><span class="annot"><span class="annottext">captionMethod :: forall a s e. (a -&gt; ZonedTime -&gt; Text) -&gt; SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#captionMethod"><span class="hs-identifier hs-var hs-var">captionMethod</span></a></span></span><span> </span><span id="local-6989586621679172590"><span class="annot"><span class="annottext">a -&gt; ZonedTime -&gt; Text
</span><a href="#local-6989586621679172590"><span class="hs-identifier hs-var">makeCaption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcCaptionMethod :: Maybe (a -&gt; ZonedTime -&gt; Text)
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcCaptionMethod"><span class="hs-identifier hs-var">_smcCaptionMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ZonedTime -&gt; Text) -&gt; Maybe (a -&gt; ZonedTime -&gt; Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ZonedTime -&gt; Text
</span><a href="#local-6989586621679172590"><span class="hs-identifier hs-var">makeCaption</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">{-|
Should be used when the confirmation dialog is not needed.
-}</span><span>
</span><span id="line-142"></span><span id="local-6989586621679172587"><span id="local-6989586621679172588"><span id="local-6989586621679172589"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm"><span class="hs-identifier hs-type">noConfirm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172588"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172587"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-143"></span><span id="noConfirm"><span class="annot"><span class="annottext">noConfirm :: forall s e a. SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm"><span class="hs-identifier hs-var hs-var">noConfirm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SaveManagerCfg s e a
forall s e a. Bool -&gt; SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm_"><span class="hs-identifier hs-var">noConfirm_</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679172707"><span id="local-6989586621679172708"><span id="local-6989586621679172709"><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm_"><span class="hs-identifier hs-type">noConfirm_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.SaveManager.SaveManagerCfg.html#SaveManagerCfg"><span class="hs-identifier hs-type">SaveManagerCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172709"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172708"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172707"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-146"></span><span id="noConfirm_"><span class="annot"><span class="annottext">noConfirm_ :: forall s e a. Bool -&gt; SaveManagerCfg s e a
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#noConfirm_"><span class="hs-identifier hs-var hs-var">noConfirm_</span></a></span></span><span> </span><span id="local-6989586621679172585"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679172585"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SaveManagerCfg s e a
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_smcNoConfirm :: Maybe Bool
</span><a href="Monomer.SaveManager.SaveManagerCfg.html#_smcNoConfirm"><span class="hs-identifier hs-var">_smcNoConfirm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679172585"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span></pre></body></html>