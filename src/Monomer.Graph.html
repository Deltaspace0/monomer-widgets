<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
This widget renders a Cartesian coordinate system and plots function
graphs by connecting provided points. Coordinate system can be
dragged and scaled. It is possible to render single points too.

This widget can receive 'GraphMsg' messages:

- 'GraphSetTranslation' 'Point'
- 'GraphSetScale' 'Point'
- 'GraphReset'

@
graph [[(1,2), (1,3)], [(0,0), (1,1)]]
graphWithColors [(red, [(1,2), (1,3)]), (blue, [(0,0), (1,1)])]
graphWithData [[graphPoint (0, 0), graphColor red]]
@
-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Monomer.Graph</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Re-exported modules</span></span><span>
</span><span id="line-23"></span><span>      </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html"><span class="hs-identifier">Monomer.Graph.GraphCfg</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphData.html"><span class="hs-identifier">Monomer.Graph.GraphData</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphMsg.html"><span class="hs-identifier">Monomer.Graph.GraphMsg</span></a></span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Constructors</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graph"><span class="hs-identifier">graph</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graph_"><span class="hs-identifier">graph_</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithColors"><span class="hs-identifier">graphWithColors</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier">graphWithColors_</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithData"><span class="hs-identifier">graphWithData</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier">graphWithData_</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Fixed</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Graphics.ColorTable</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Widgets.Single</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Lens</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html"><span class="hs-identifier">Monomer.Graph.GraphCfg</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphData.html"><span class="hs-identifier">Monomer.Graph.GraphData</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphMsg.html"><span class="hs-identifier">Monomer.Graph.GraphMsg</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphState.html"><span class="hs-identifier">Monomer.Graph.GraphState</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with points.
-}</span><span>
</span><span id="line-55"></span><span id="local-6989586621679172583"><span id="local-6989586621679172584"><span class="annot"><a href="Monomer.Graph.html#graph"><span class="hs-identifier hs-type">graph</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The list with points.</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679172584"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172583"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>        </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-58"></span><span id="graph"><span class="annot"><span class="annottext">graph :: forall s e. [[(Double, Double)]] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graph"><span class="hs-identifier hs-var hs-var">graph</span></a></span></span><span> </span><span id="local-6989586621679172395"><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679172395"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]] -&gt; [GraphCfg] -&gt; WidgetNode s e
forall s e. [[(Double, Double)]] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graph_"><span class="hs-identifier hs-var">graph_</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679172395"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with points. Accepts config.
-}</span><span>
</span><span id="line-63"></span><span id="local-6989586621679172575"><span id="local-6989586621679172576"><span class="annot"><a href="Monomer.Graph.html#graph_"><span class="hs-identifier hs-type">graph_</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The list with points.</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span class="hs-special">]</span><span>            </span><span class="hs-comment">-- ^ The config options.</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679172576"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172575"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>        </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-67"></span><span id="graph_"><span class="annot"><span class="annottext">graph_ :: forall s e. [[(Double, Double)]] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graph_"><span class="hs-identifier hs-var hs-var">graph_</span></a></span></span><span> </span><span id="local-6989586621679172393"><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679172393"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span id="local-6989586621679172392"><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172392"><span class="hs-identifier hs-var">configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])] -&gt; [GraphCfg] -&gt; WidgetNode s e
forall s e.
[(Color, [(Double, Double)])] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-var">graphWithColors_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679172391"><span class="hs-identifier hs-var">colorPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172392"><span class="hs-identifier hs-var">configs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621679172391"><span class="annot"><span class="annottext">colorPoints :: [(Color, [(Double, Double)])]
</span><a href="#local-6989586621679172391"><span class="hs-identifier hs-var hs-var">colorPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Color] -&gt; [[(Double, Double)]] -&gt; [(Color, [(Double, Double)])]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Color] -&gt; [Color]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Color]
</span><a href="#local-6989586621679172389"><span class="hs-identifier hs-var">colors'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679172393"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679172389"><span class="annot"><span class="annottext">colors' :: [Color]
</span><a href="#local-6989586621679172389"><span class="hs-identifier hs-var hs-var">colors'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Color] -&gt; Maybe [Color] -&gt; [Color]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[Color]
</span><a href="#local-6989586621679172387"><span class="hs-identifier hs-var">colors</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Color] -&gt; [Color]) -&gt; Maybe [Color] -&gt; [Color]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphCfg -&gt; Maybe [Color]
</span><a href="Monomer.Graph.GraphCfg.html#_gcGraphColors"><span class="hs-identifier hs-var hs-var">_gcGraphColors</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172385"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679172387"><span class="annot"><span class="annottext">colors :: [Color]
</span><a href="#local-6989586621679172387"><span class="hs-identifier hs-var hs-var">colors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">red</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">green</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">blue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">violet</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">yellow</span></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679172385"><span class="annot"><span class="annottext">config :: GraphCfg
</span><a href="#local-6989586621679172385"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GraphCfg] -&gt; GraphCfg
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172392"><span class="hs-identifier hs-var">configs</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with colors and points.
-}</span><span>
</span><span id="line-76"></span><span id="local-6989586621679172559"><span id="local-6989586621679172560"><span class="annot"><a href="Monomer.Graph.html#graphWithColors"><span class="hs-identifier hs-type">graphWithColors</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- ^ The list with colors and points.</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679172560"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172559"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-81"></span><span id="graphWithColors"><span class="annot"><span class="annottext">graphWithColors :: forall s e. [(Color, [(Double, Double)])] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors"><span class="hs-identifier hs-var hs-var">graphWithColors</span></a></span></span><span> </span><span id="local-6989586621679172376"><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679172376"><span class="hs-identifier hs-var">colorPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])] -&gt; [GraphCfg] -&gt; WidgetNode s e
forall s e.
[(Color, [(Double, Double)])] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-var">graphWithColors_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679172376"><span class="hs-identifier hs-var">colorPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with colors and points.
Accepts config.
-}</span><span>
</span><span id="line-87"></span><span id="local-6989586621679172569"><span id="local-6989586621679172570"><span class="annot"><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-type">graphWithColors_</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- ^ The list with colors and points.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- ^ The config options.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679172570"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172569"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-94"></span><span id="graphWithColors_"><span class="annot"><span class="annottext">graphWithColors_ :: forall s e.
[(Color, [(Double, Double)])] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-var hs-var">graphWithColors_</span></a></span></span><span> </span><span id="local-6989586621679172375"><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679172375"><span class="hs-identifier hs-var">colorPoints</span></a></span></span><span> </span><span id="local-6989586621679172374"><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172374"><span class="hs-identifier hs-var">configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
forall {s} {e}. WidgetNode s e
</span><a href="#local-6989586621679172373"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679172373"><span class="annot"><span class="annottext">node :: WidgetNode s e
</span><a href="#local-6989586621679172373"><span class="hs-identifier hs-var hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[GraphData]] -&gt; [GraphCfg] -&gt; WidgetNode s e
forall s e. [[GraphData]] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-var">graphWithData_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Color, [(Double, Double)]) -&gt; [GraphData]
</span><a href="#local-6989586621679172370"><span class="hs-identifier hs-var">makeData</span></a></span><span> </span><span class="annot"><span class="annottext">((Color, [(Double, Double)]) -&gt; [GraphData])
-&gt; [(Color, [(Double, Double)])] -&gt; [[GraphData]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679172375"><span class="hs-identifier hs-var">colorPoints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172374"><span class="hs-identifier hs-var">configs</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679172370"><span class="annot"><span class="annottext">makeData :: (Color, [(Double, Double)]) -&gt; [GraphData]
</span><a href="#local-6989586621679172370"><span class="hs-identifier hs-var hs-var">makeData</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679172368"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679172368"><span class="hs-identifier hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679172367"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679172367"><span class="hs-identifier hs-var">points</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; GraphData
</span><a href="Monomer.Graph.GraphData.html#graphPoints"><span class="hs-identifier hs-var">graphPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679172367"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color -&gt; GraphData
</span><a href="Monomer.Graph.GraphData.html#graphColor"><span class="hs-identifier hs-var">graphColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679172368"><span class="hs-identifier hs-var">color</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with 'GraphData'.
-}</span><span>
</span><span id="line-104"></span><span id="local-6989586621679172545"><span id="local-6989586621679172546"><span class="annot"><a href="Monomer.Graph.html#graphWithData"><span class="hs-identifier hs-type">graphWithData</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ The list with 'GraphData'.</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679172546"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172545"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>  </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-107"></span><span id="graphWithData"><span class="annot"><span class="annottext">graphWithData :: forall s e. [[GraphData]] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData"><span class="hs-identifier hs-var hs-var">graphWithData</span></a></span></span><span> </span><span id="local-6989586621679172363"><span class="annot"><span class="annottext">[[GraphData]]
</span><a href="#local-6989586621679172363"><span class="hs-identifier hs-var">dataList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[GraphData]] -&gt; [GraphCfg] -&gt; WidgetNode s e
forall s e. [[GraphData]] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-var">graphWithData_</span></a></span><span> </span><span class="annot"><span class="annottext">[[GraphData]]
</span><a href="#local-6989586621679172363"><span class="hs-identifier hs-var">dataList</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with 'GraphData'. Accepts
config.
-}</span><span>
</span><span id="line-113"></span><span id="local-6989586621679172550"><span id="local-6989586621679172551"><span class="annot"><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-type">graphWithData_</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ The list with 'GraphData'.</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- ^ The config options.</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679172551"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172550"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>  </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-117"></span><span id="graphWithData_"><span class="annot"><span class="annottext">graphWithData_ :: forall s e. [[GraphData]] -&gt; [GraphCfg] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-var hs-var">graphWithData_</span></a></span></span><span> </span><span id="local-6989586621679172362"><span class="annot"><span class="annottext">[[GraphData]]
</span><a href="#local-6989586621679172362"><span class="hs-identifier hs-var">dataList</span></a></span></span><span> </span><span id="local-6989586621679172361"><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172361"><span class="hs-identifier hs-var">configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
forall {s} {e}. WidgetNode s e
</span><a href="#local-6989586621679172360"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679172360"><span class="annot"><span class="annottext">node :: WidgetNode s e
</span><a href="#local-6989586621679172360"><span class="hs-identifier hs-var hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetType -&gt; Widget s e -&gt; WidgetNode s e
forall s e. WidgetType -&gt; Widget s e -&gt; WidgetNode s e
</span><span class="hs-identifier hs-var">defaultWidgetNode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; WidgetType
</span><span class="hs-identifier hs-var">WidgetType</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;graph&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Widget s e
forall {s} {e}. Widget s e
</span><a href="#local-6989586621679172355"><span class="hs-identifier hs-var">widget</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679172355"><span class="annot"><span class="annottext">widget :: Widget s e
</span><a href="#local-6989586621679172355"><span class="hs-identifier hs-var hs-var">widget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GraphData] -&gt; GraphCfg -&gt; GraphState -&gt; Widget s e
forall s e. [GraphData] -&gt; GraphCfg -&gt; GraphState -&gt; Widget s e
</span><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-var">makeGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GraphData] -&gt; GraphData
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([GraphData] -&gt; GraphData) -&gt; [[GraphData]] -&gt; [GraphData]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[GraphData]]
</span><a href="#local-6989586621679172362"><span class="hs-identifier hs-var">dataList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172348"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679172348"><span class="annot"><span class="annottext">config :: GraphCfg
</span><a href="#local-6989586621679172348"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GraphCfg] -&gt; GraphCfg
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[GraphCfg]
</span><a href="#local-6989586621679172361"><span class="hs-identifier hs-var">configs</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621679172529"><span id="local-6989586621679172530"><span class="annot"><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-type">makeGraph</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphState.html#GraphState"><span class="hs-identifier hs-type">GraphState</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Widget</span></span><span> </span><span class="annot"><a href="#local-6989586621679172530"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172529"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-127"></span><span id="makeGraph"><span class="annot"><span class="annottext">makeGraph :: forall s e. [GraphData] -&gt; GraphCfg -&gt; GraphState -&gt; Widget s e
</span><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-var hs-var">makeGraph</span></a></span></span><span> </span><span id="local-6989586621679172335"><span class="annot"><span class="annottext">[GraphData]
</span><a href="#local-6989586621679172335"><span class="hs-identifier hs-var">graphDatas</span></a></span></span><span> </span><span id="local-6989586621679172334"><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679172333"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget s e
forall {s} {e}. Widget s e
</span><a href="#local-6989586621679172332"><span class="hs-identifier hs-var">widget</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679172332"><span class="annot"><span class="annottext">widget :: Widget s e
</span><a href="#local-6989586621679172332"><span class="hs-identifier hs-var hs-var">widget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Single s e GraphState -&gt; Widget s e
forall a s e. WidgetModel a =&gt; a -&gt; Single s e a -&gt; Widget s e
</span><span class="hs-identifier hs-var">createSingle</span></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">Single s e Any
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">singleMerge :: SingleMergeHandler s e GraphState
</span><span class="hs-identifier hs-var">singleMerge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleMergeHandler s e GraphState
forall {p} {s} {e} {p}.
p -&gt; WidgetNode s e -&gt; p -&gt; GraphState -&gt; WidgetResult s e
</span><a href="#local-6989586621679172326"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleHandleEvent :: SingleEventHandler s e
</span><span class="hs-identifier hs-var">singleHandleEvent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleEventHandler s e
forall {s} {e} {p}.
WidgetEnv s e
-&gt; WidgetNode s e -&gt; p -&gt; SystemEvent -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172324"><span class="hs-identifier hs-var">handleEvent</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleHandleMessage :: SingleMessageHandler s e
</span><span class="hs-identifier hs-var">singleHandleMessage</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleMessageHandler s e
forall {a} {p} {s} {e} {p}.
Typeable a =&gt;
p -&gt; WidgetNode s e -&gt; p -&gt; a -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172322"><span class="hs-identifier hs-var">handleMessage</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleGetSizeReq :: SingleGetSizeReqHandler s e
</span><span class="hs-identifier hs-var">singleGetSizeReq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleGetSizeReqHandler s e
forall {p} {p}. p -&gt; p -&gt; (SizeReq, SizeReq)
</span><a href="#local-6989586621679172318"><span class="hs-identifier hs-var">getSizeReq</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleRender :: SingleRenderHandler s e
</span><span class="hs-identifier hs-var">singleRender</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleRenderHandler s e
forall {s} {e}.
WidgetEnv s e -&gt; WidgetNode s e -&gt; Renderer -&gt; IO ()
</span><a href="#local-6989586621679172316"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679172326"><span class="annot"><span class="annottext">merge :: p -&gt; WidgetNode s e -&gt; p -&gt; GraphState -&gt; WidgetResult s e
</span><a href="#local-6989586621679172326"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679172315"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172315"><span class="hs-identifier hs-var">newNode</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679172314"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172314"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; WidgetResult s e
forall s e. WidgetNode s e -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultNode</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172312"><span class="hs-identifier hs-var">resNode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>        </span><span id="local-6989586621679172312"><span class="annot"><span class="annottext">resNode :: WidgetNode s e
</span><a href="#local-6989586621679172312"><span class="hs-identifier hs-var hs-var">resNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172315"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
-&gt; (WidgetNode s e -&gt; WidgetNode s e) -&gt; WidgetNode s e
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Widget s e -&gt; Identity (Widget s e))
-&gt; WidgetNode s e -&gt; Identity (WidgetNode s e)
forall s a. HasWidget s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.widget</span></span><span> </span><span class="annot"><span class="annottext">((Widget s e -&gt; Identity (Widget s e))
 -&gt; WidgetNode s e -&gt; Identity (WidgetNode s e))
-&gt; Widget s e -&gt; WidgetNode s e -&gt; WidgetNode s e
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Widget s e
forall {s} {e}. GraphState -&gt; Widget s e
</span><a href="#local-6989586621679172304"><span class="hs-identifier hs-var">makeGraphWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172314"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679172324"><span class="annot"><span class="annottext">handleEvent :: WidgetEnv s e
-&gt; WidgetNode s e -&gt; p -&gt; SystemEvent -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172324"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span id="local-6989586621679172303"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679172303"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679172302"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172302"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679172301"><span class="annot"><span class="annottext">SystemEvent
</span><a href="#local-6989586621679172301"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172300"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>        </span><span id="local-6989586621679172300"><span class="annot"><span class="annottext">result :: Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172300"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SystemEvent
</span><a href="#local-6989586621679172301"><span class="hs-identifier hs-var">event</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">ButtonAction</span></span><span> </span><span id="local-6989586621679172298"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172298"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ButtonState
</span><span class="hs-identifier hs-var">BtnPressed</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172296"><span class="hs-identifier hs-var">resultPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172298"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-142"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">ButtonAction</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ButtonState
</span><span class="hs-identifier hs-var">BtnReleased</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172294"><span class="hs-identifier hs-var">resultReleased</span></a></span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Move</span></span><span> </span><span id="local-6989586621679172292"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172292"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e -&gt; WidgetNode s e -&gt; Bool
forall s e. WidgetEnv s e -&gt; WidgetNode s e -&gt; Bool
</span><span class="hs-identifier hs-var">isNodePressed</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679172303"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172302"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172296"><span class="hs-identifier hs-var">resultPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172292"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">WheelScroll</span></span><span> </span><span id="local-6989586621679172289"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172289"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679172287"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172287"><span class="hs-identifier hs-var">wy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WheelDirection
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172286"><span class="hs-identifier hs-var">resultScroll</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172289"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172287"><span class="hs-identifier hs-var">wy</span></a></span><span>
</span><span id="line-145"></span><span>            </span><span class="annot"><span class="annottext">SystemEvent
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (WidgetResult s e)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621679172296"><span class="annot"><span class="annottext">resultPoint :: Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172296"><span class="hs-identifier hs-var hs-var">resultPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; Maybe (WidgetResult s e)
forall {s} {e}. WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172284"><span class="hs-identifier hs-var">resultRender</span></a></span><span> </span><span class="annot"><span class="annottext">(WidgetNode s e -&gt; Maybe (WidgetResult s e))
-&gt; (Point -&gt; WidgetNode s e) -&gt; Point -&gt; Maybe (WidgetResult s e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; WidgetNode s e
forall {s} {e}.
HasWidget (WidgetNode s e) (Widget s e) =&gt;
Point -&gt; WidgetNode s e
</span><a href="#local-6989586621679172282"><span class="hs-identifier hs-var">newPoint</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span id="local-6989586621679172286"><span class="annot"><span class="annottext">resultScroll :: Point -&gt; Double -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172286"><span class="hs-identifier hs-var hs-var">resultScroll</span></a></span></span><span> </span><span id="local-6989586621679172280"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172280"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; Maybe (WidgetResult s e)
forall {s} {e}. WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172284"><span class="hs-identifier hs-var">resultRender</span></a></span><span> </span><span class="annot"><span class="annottext">(WidgetNode s e -&gt; Maybe (WidgetResult s e))
-&gt; (Double -&gt; WidgetNode s e) -&gt; Double -&gt; Maybe (WidgetResult s e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; WidgetNode s e
forall {s} {e}.
HasWidget (WidgetNode s e) (Widget s e) =&gt;
Point -&gt; Double -&gt; WidgetNode s e
</span><a href="#local-6989586621679172279"><span class="hs-identifier hs-var">newScroll</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172280"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span id="local-6989586621679172294"><span class="annot"><span class="annottext">resultReleased :: Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172294"><span class="hs-identifier hs-var hs-var">resultReleased</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetResult s e -&gt; Maybe (WidgetResult s e)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(WidgetResult s e -&gt; Maybe (WidgetResult s e))
-&gt; WidgetResult s e -&gt; Maybe (WidgetResult s e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; WidgetResult s e
forall s e. WidgetNode s e -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultNode</span></span><span> </span><span class="annot"><span class="annottext">(WidgetNode s e -&gt; WidgetResult s e)
-&gt; WidgetNode s e -&gt; WidgetResult s e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; WidgetNode s e
forall {s} {e}.
HasWidget (WidgetNode s e) (Widget s e) =&gt;
GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679172277"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphState -&gt; WidgetNode s e) -&gt; GraphState -&gt; WidgetNode s e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsMousePosition :: Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Point
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-151"></span><span>        </span><span id="local-6989586621679172282"><span class="annot"><span class="annottext">newPoint :: Point -&gt; WidgetNode s e
</span><a href="#local-6989586621679172282"><span class="hs-identifier hs-var hs-var">newPoint</span></a></span></span><span> </span><span id="local-6989586621679172267"><span class="annot"><span class="annottext">point :: Point
</span><a href="#local-6989586621679172267"><span class="hs-identifier hs-var">point</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679172266"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172266"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679172265"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172265"><span class="hs-identifier hs-var">my</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; WidgetNode s e
forall {s} {e}.
HasWidget (WidgetNode s e) (Widget s e) =&gt;
GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679172277"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphState -&gt; WidgetNode s e) -&gt; GraphState -&gt; WidgetNode s e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Point -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Maybe Point
</span><a href="#local-6989586621679172263"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsMousePosition :: Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe Point
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172267"><span class="hs-identifier hs-var">point</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-154"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172261"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172266"><span class="hs-identifier hs-var">mx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172259"><span class="hs-identifier hs-var">mx0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172258"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172265"><span class="hs-identifier hs-var">my</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172257"><span class="hs-identifier hs-var">my0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsMousePosition :: Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe Point
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172267"><span class="hs-identifier hs-var">point</span></a></span><span>
</span><span id="line-156"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679172279"><span class="annot"><span class="annottext">newScroll :: Point -&gt; Double -&gt; WidgetNode s e
</span><a href="#local-6989586621679172279"><span class="hs-identifier hs-var hs-var">newScroll</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679172246"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172246"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679172245"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172245"><span class="hs-identifier hs-var">my</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679172244"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172244"><span class="hs-identifier hs-var">wy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; WidgetNode s e
forall {s} {e}.
HasWidget (WidgetNode s e) (Widget s e) =&gt;
GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679172277"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphState -&gt; WidgetNode s e) -&gt; GraphState -&gt; WidgetNode s e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-158"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172243"><span class="hs-identifier hs-var">tx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172242"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-159"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsScale :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172240"><span class="hs-identifier hs-var">cx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172239"><span class="hs-identifier hs-var">cy'</span></a></span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsUnit :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsUnit"><span class="hs-identifier hs-var">_gsUnit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172237"><span class="hs-identifier hs-var">ux</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172236"><span class="hs-identifier hs-var">uy</span></a></span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsSections :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsSections"><span class="hs-identifier hs-var">_gsSections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall {p} {p}. (Num p, Floating p, Real p) =&gt; p -&gt; p
</span><a href="#local-6989586621679172234"><span class="hs-identifier hs-var">getSec</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172240"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall {p} {p}. (Num p, Floating p, Real p) =&gt; p -&gt; p
</span><a href="#local-6989586621679172234"><span class="hs-identifier hs-var">getSec</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172239"><span class="hs-identifier hs-var">cy'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>                </span><span id="local-6989586621679172243"><span class="annot"><span class="annottext">tx' :: Double
</span><a href="#local-6989586621679172243"><span class="hs-identifier hs-var hs-var">tx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172228"><span class="hs-identifier hs-var">mx'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172228"><span class="hs-identifier hs-var">mx'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172261"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172240"><span class="hs-identifier hs-var">cx'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172225"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-164"></span><span>                </span><span id="local-6989586621679172242"><span class="annot"><span class="annottext">ty' :: Double
</span><a href="#local-6989586621679172242"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172220"><span class="hs-identifier hs-var">my'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172220"><span class="hs-identifier hs-var">my'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172258"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172239"><span class="hs-identifier hs-var">cy'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172219"><span class="hs-identifier hs-var">cy</span></a></span><span>
</span><span id="line-165"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679172228"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172228"><span class="hs-identifier hs-var">mx'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679172220"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172220"><span class="hs-identifier hs-var">my'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172246"><span class="hs-identifier hs-var">mx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172210"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172209"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172245"><span class="hs-identifier hs-var">my</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172208"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172207"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679172237"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172237"><span class="hs-identifier hs-var">ux</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679172236"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172236"><span class="hs-identifier hs-var">uy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679172206"><span class="hs-identifier hs-var">getUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172240"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679172206"><span class="hs-identifier hs-var">getUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172239"><span class="hs-identifier hs-var">cy'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679172240"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172240"><span class="hs-identifier hs-var">cx'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679172239"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172239"><span class="hs-identifier hs-var">cy'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172225"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172201"><span class="hs-identifier hs-var">rateX</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172244"><span class="hs-identifier hs-var">wy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172219"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172199"><span class="hs-identifier hs-var">rateY</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172244"><span class="hs-identifier hs-var">wy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>                </span><span id="local-6989586621679172201"><span class="annot"><span class="annottext">rateX :: Double
</span><a href="#local-6989586621679172201"><span class="hs-identifier hs-var hs-var">rateX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GraphCfg -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphCfg.html#_gcLockX"><span class="hs-identifier hs-var hs-var">_gcLockX</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-169"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-170"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.05</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172190"><span class="hs-identifier hs-var">wr</span></a></span><span>
</span><span id="line-171"></span><span>                </span><span id="local-6989586621679172199"><span class="annot"><span class="annottext">rateY :: Double
</span><a href="#local-6989586621679172199"><span class="hs-identifier hs-var hs-var">rateY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GraphCfg -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphCfg.html#_gcLockY"><span class="hs-identifier hs-var hs-var">_gcLockY</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-172"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-173"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.05</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172190"><span class="hs-identifier hs-var">wr</span></a></span><span>
</span><span id="line-174"></span><span>                </span><span id="local-6989586621679172190"><span class="annot"><span class="annottext">wr :: Double
</span><a href="#local-6989586621679172190"><span class="hs-identifier hs-var hs-var">wr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Maybe Double -&gt; Double
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Double) -&gt; Maybe Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphCfg -&gt; Maybe Double
</span><a href="Monomer.Graph.GraphCfg.html#_gcWheelRate"><span class="hs-identifier hs-var hs-var">_gcWheelRate</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Rect</span></span><span> </span><span id="local-6989586621679172210"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172210"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679172208"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172208"><span class="hs-identifier hs-var">gy</span></a></span></span><span> </span><span id="local-6989586621679172209"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172209"><span class="hs-identifier hs-var">gw</span></a></span></span><span> </span><span id="local-6989586621679172207"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172207"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; StyleState -&gt; Rect
forall s e. WidgetNode s e -&gt; StyleState -&gt; Rect
</span><span class="hs-identifier hs-var">getContentArea</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172302"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679172179"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621679172179"><span class="annot"><span class="annottext">style :: StyleState
</span><a href="#local-6989586621679172179"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
forall s e. WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><span class="hs-identifier hs-var">currentStyle</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679172303"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172302"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679172234"><span class="annot"><span class="annottext">getSec :: p -&gt; p
</span><a href="#local-6989586621679172234"><span class="hs-identifier hs-var hs-var">getSec</span></a></span></span><span> </span><span id="local-6989586621679172164"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679172164"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679172157"><span class="annot"><span class="annottext">l :: p
</span><a href="#local-6989586621679172157"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Real a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679172164"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-178"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679172157"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">5</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">4</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">5</span></span><span>
</span><span id="line-179"></span><span>        </span><span id="local-6989586621679172206"><span class="annot"><span class="annottext">getUnit :: Double -&gt; Double
</span><a href="#local-6989586621679172206"><span class="hs-identifier hs-var hs-var">getUnit</span></a></span></span><span> </span><span id="local-6989586621679172143"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172143"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172142"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-181"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172142"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>                </span><span id="local-6989586621679172142"><span class="annot"><span class="annottext">l :: Double
</span><a href="#local-6989586621679172142"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Real a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172143"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                </span><span id="local-6989586621679172141"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679172141"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679172127"><span class="hs-identifier hs-var">floor'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172143"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679172261"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172261"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679172258"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172258"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var hs-var">_gsTranslation</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679172225"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172225"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679172219"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172219"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var hs-var">_gsScale</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679172259"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172259"><span class="hs-identifier hs-var">mx0</span></a></span></span><span> </span><span id="local-6989586621679172257"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679172257"><span class="hs-identifier hs-var">my0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Point -&gt; Point
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Point
</span><a href="#local-6989586621679172263"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span id="local-6989586621679172263"><span class="annot"><span class="annottext">mp :: Maybe Point
</span><a href="#local-6989586621679172263"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var hs-var">_gsMousePosition</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span id="local-6989586621679172284"><span class="annot"><span class="annottext">resultRender :: WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172284"><span class="hs-identifier hs-var hs-var">resultRender</span></a></span></span><span> </span><span id="local-6989586621679172123"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172123"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetResult s e -&gt; Maybe (WidgetResult s e)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(WidgetResult s e -&gt; Maybe (WidgetResult s e))
-&gt; WidgetResult s e -&gt; Maybe (WidgetResult s e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172123"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">WidgetRequest s e
forall s e. WidgetRequest s e
</span><span class="hs-identifier hs-var">RenderOnce</span></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>        </span><span id="local-6989586621679172277"><span class="annot"><span class="annottext">newNode :: GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679172277"><span class="hs-identifier hs-var hs-var">newNode</span></a></span></span><span> </span><span id="local-6989586621679172117"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172117"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172302"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
-&gt; (WidgetNode s e -&gt; WidgetNode s e) -&gt; WidgetNode s e
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Widget s e -&gt; Identity (Widget s e))
-&gt; WidgetNode s e -&gt; Identity (WidgetNode s e)
forall s a. HasWidget s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.widget</span></span><span> </span><span class="annot"><span class="annottext">((Widget s e -&gt; Identity (Widget s e))
 -&gt; WidgetNode s e -&gt; Identity (WidgetNode s e))
-&gt; Widget s e -&gt; WidgetNode s e -&gt; WidgetNode s e
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Widget s e
forall {s} {e}. GraphState -&gt; Widget s e
</span><a href="#local-6989586621679172304"><span class="hs-identifier hs-var">makeGraphWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172117"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679172322"><span class="annot"><span class="annottext">handleMessage :: p -&gt; WidgetNode s e -&gt; p -&gt; a -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679172322"><span class="hs-identifier hs-var hs-var">handleMessage</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679172108"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172108"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679172107"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172107"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621679172106"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172106"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GraphMsg -&gt; GraphState
</span><a href="#local-6989586621679172105"><span class="hs-identifier hs-var">getNewState</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphMsg -&gt; GraphState) -&gt; Maybe GraphMsg -&gt; Maybe GraphState
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe GraphMsg
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172107"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679172101"><span class="annot"><span class="annottext">newNode :: WidgetNode s e
</span><a href="#local-6989586621679172101"><span class="hs-identifier hs-var hs-var">newNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172108"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
-&gt; (WidgetNode s e -&gt; WidgetNode s e) -&gt; WidgetNode s e
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Widget s e -&gt; Identity (Widget s e))
-&gt; WidgetNode s e -&gt; Identity (WidgetNode s e)
forall s a. HasWidget s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.widget</span></span><span> </span><span class="annot"><span class="annottext">((Widget s e -&gt; Identity (Widget s e))
 -&gt; WidgetNode s e -&gt; Identity (WidgetNode s e))
-&gt; Widget s e -&gt; WidgetNode s e -&gt; WidgetNode s e
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Widget s e
forall {s} {e}. GraphState -&gt; Widget s e
</span><a href="#local-6989586621679172304"><span class="hs-identifier hs-var">makeGraphWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172106"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">WidgetResult s e -&gt; Maybe (WidgetResult s e)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(WidgetResult s e -&gt; Maybe (WidgetResult s e))
-&gt; WidgetResult s e -&gt; Maybe (WidgetResult s e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679172101"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">WidgetRequest s e
forall s e. WidgetRequest s e
</span><span class="hs-identifier hs-var">RenderOnce</span></span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679172105"><span class="annot"><span class="annottext">getNewState :: GraphMsg -&gt; GraphState
</span><a href="#local-6989586621679172105"><span class="hs-identifier hs-var hs-var">getNewState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.Graph.GraphMsg.html#GraphSetTranslation"><span class="hs-identifier hs-type">GraphSetTranslation</span></a></span><span> </span><span id="local-6989586621679172098"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172098"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172098"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621679172105"><span class="hs-identifier hs-var">getNewState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.Graph.GraphMsg.html#GraphSetScale"><span class="hs-identifier hs-type">GraphSetScale</span></a></span><span> </span><span id="local-6989586621679172096"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172096"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsScale :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679172096"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="#local-6989586621679172105"><span class="hs-identifier hs-var">getNewState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphMsg
</span><a href="Monomer.Graph.GraphMsg.html#GraphReset"><span class="hs-identifier hs-var">GraphReset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679172318"><span class="annot"><span class="annottext">getSizeReq :: p -&gt; p -&gt; (SizeReq, SizeReq)
</span><a href="#local-6989586621679172318"><span class="hs-identifier hs-var hs-var">getSizeReq</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; SizeReq
</span><span class="hs-identifier hs-var">minSize</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; SizeReq
</span><span class="hs-identifier hs-var">minSize</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679172316"><span class="annot"><span class="annottext">render :: WidgetEnv s e -&gt; WidgetNode s e -&gt; Renderer -&gt; IO ()
</span><a href="#local-6989586621679172316"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679171993"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679171993"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679171992"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679171992"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679171991"><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679171990"><span class="annot"><span class="annottext">style :: StyleState
</span><a href="#local-6989586621679171990"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
forall s e. WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><span class="hs-identifier hs-var">currentStyle</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679171993"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679171992"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span id="local-6989586621679171989"><span class="annot"><span class="annottext">rect :: Rect
</span><a href="#local-6989586621679171989"><span class="hs-identifier hs-var">rect</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rect</span></span><span> </span><span id="local-6989586621679171988"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679171987"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span></span><span> </span><span id="local-6989586621679171986"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span></span><span> </span><span id="local-6989586621679171985"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; StyleState -&gt; Rect
forall s e. WidgetNode s e -&gt; StyleState -&gt; Rect
</span><span class="hs-identifier hs-var">getContentArea</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679171992"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679171990"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679171984"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171984"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679171983"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171983"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var hs-var">_gsTranslation</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679171982"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171982"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679171981"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171981"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var hs-var">_gsScale</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679171980"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171980"><span class="hs-identifier hs-var">ux</span></a></span></span><span> </span><span id="local-6989586621679171979"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171979"><span class="hs-identifier hs-var">uy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsUnit"><span class="hs-identifier hs-var hs-var">_gsUnit</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679171978"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171978"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679171977"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171977"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsSections"><span class="hs-identifier hs-var hs-var">_gsSections</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679172333"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-211"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679171968"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171967"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171984"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171983"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679171965"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171965"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171964"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171964"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679171962"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171962"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171961"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171961"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>            </span><span id="local-6989586621679171960"><span class="annot"><span class="annottext">line :: Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679171960"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679171959"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171959"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679171958"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171958"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679171957"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171957"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679171956"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679171956"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; Point -&gt; Double -&gt; Maybe Color -&gt; IO ()
</span><span class="hs-identifier hs-var">drawLine</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171959"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171958"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171957"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Color -&gt; IO ()) -&gt; Maybe Color -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; Maybe Color
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679171956"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-215"></span><span>            </span><span id="local-6989586621679171954"><span class="annot"><span class="annottext">font :: Font
</span><a href="#local-6989586621679171954"><span class="hs-identifier hs-var hs-var">font</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StyleState -&gt; Font
</span><span class="hs-identifier hs-var">styleFont</span></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679171990"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-216"></span><span>            </span><span id="local-6989586621679171952"><span class="annot"><span class="annottext">fsize :: FontSize
</span><a href="#local-6989586621679171952"><span class="hs-identifier hs-var hs-var">fsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FontSize
</span><span class="hs-identifier hs-var">FontSize</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span>
</span><span id="line-217"></span><span>            </span><span id="local-6989586621679171948"><span class="annot"><span class="annottext">printText :: Point -&gt; Text -&gt; IO ()
</span><a href="#local-6989586621679171948"><span class="hs-identifier hs-var hs-var">printText</span></a></span></span><span> </span><span id="local-6989586621679171947"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171947"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679171946"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679171946"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; Font -&gt; FontSize -&gt; FontSpace -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">renderText</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171947"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Font
</span><a href="#local-6989586621679171954"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">FontSize
</span><a href="#local-6989586621679171952"><span class="hs-identifier hs-var">fsize</span></a></span><span> </span><span class="annot"><span class="annottext">FontSpace
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679171946"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span id="local-6989586621679171944"><span class="annot"><span class="annottext">show' :: Double -&gt; String
</span><a href="#local-6989586621679171944"><span class="hs-identifier hs-var hs-var">show'</span></a></span></span><span> </span><span id="local-6989586621679171943"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171943"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679171942"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>                </span><span id="local-6989586621679171942"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679171942"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171943"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171943"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-220"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171943"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Double -&gt; ShowS
forall a. RealFloat a =&gt; Maybe Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showFFloat</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171929"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-222"></span><span>                </span><span id="local-6989586621679171929"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679171929"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171943"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171926"><span class="hs-identifier hs-var">bn</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171926"><span class="hs-identifier hs-var">bn</span></a></span><span>
</span><span id="line-223"></span><span>                </span><span id="local-6989586621679171926"><span class="annot"><span class="annottext">bn :: Double
</span><a href="#local-6989586621679171926"><span class="hs-identifier hs-var hs-var">bn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1000000000</span></span><span>
</span><span id="line-224"></span><span>            </span><span id="local-6989586621679171924"><span class="annot"><span class="annottext">printN :: Point -&gt; Double -&gt; IO ()
</span><a href="#local-6989586621679171924"><span class="hs-identifier hs-var hs-var">printN</span></a></span></span><span> </span><span id="local-6989586621679171923"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171923"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Text -&gt; IO ()
</span><a href="#local-6989586621679171948"><span class="hs-identifier hs-var">printText</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171923"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; (Double -&gt; Text) -&gt; Double -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (Double -&gt; String) -&gt; Double -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
</span><a href="#local-6989586621679171944"><span class="hs-identifier hs-var">show'</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; Rect -&gt; Maybe Color -&gt; Maybe Radius -&gt; IO ()
</span><span class="hs-identifier hs-var">drawRect</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679171989"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Maybe Color
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">white</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Radius
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">saveContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; Rect -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">intersectScissor</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679171989"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679171960"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171965"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171964"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679171960"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171962"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679171961"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171911"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171910"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171982"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171980"><span class="hs-identifier hs-var">ux</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171981"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171979"><span class="hs-identifier hs-var">uy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>            </span><span id="local-6989586621679171908"><span class="annot"><span class="annottext">verLine :: Double -&gt; IO ()
</span><a href="#local-6989586621679171908"><span class="hs-identifier hs-var hs-var">verLine</span></a></span></span><span> </span><span id="local-6989586621679171907"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171907"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679171960"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171907"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171907"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span>
</span><span id="line-232"></span><span>            </span><span id="local-6989586621679171905"><span class="annot"><span class="annottext">horLine :: Double -&gt; IO ()
</span><a href="#local-6989586621679171905"><span class="hs-identifier hs-var hs-var">horLine</span></a></span></span><span> </span><span id="local-6989586621679171904"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171904"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679171960"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171904"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171904"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span>
</span><span id="line-233"></span><span>            </span><span id="local-6989586621679171898"><span class="annot"><span class="annottext">uxl :: Double -&gt; b
</span><a href="#local-6989586621679171898"><span class="hs-identifier hs-var hs-var">uxl</span></a></span></span><span> </span><span id="local-6989586621679171897"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171897"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; b
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; b) -&gt; Int -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; String -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
</span><a href="#local-6989586621679171944"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; String) -&gt; Double -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171979"><span class="hs-identifier hs-var">uy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171897"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-234"></span><span>            </span><span id="local-6989586621679171882"><span class="annot"><span class="annottext">clampX :: Double -&gt; Double
</span><a href="#local-6989586621679171882"><span class="hs-identifier hs-var hs-var">clampX</span></a></span></span><span> </span><span id="local-6989586621679171881"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171881"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall {b}. Num b =&gt; Double -&gt; b
</span><a href="#local-6989586621679171898"><span class="hs-identifier hs-var">uxl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171881"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span>
</span><span id="line-235"></span><span>            </span><span id="local-6989586621679171869"><span class="annot"><span class="annottext">clampY :: Double
</span><a href="#local-6989586621679171869"><span class="hs-identifier hs-var hs-var">clampY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span>
</span><span id="line-236"></span><span>            </span><span id="local-6989586621679171863"><span class="annot"><span class="annottext">verN :: Double -&gt; IO ()
</span><a href="#local-6989586621679171863"><span class="hs-identifier hs-var hs-var">verN</span></a></span></span><span> </span><span id="local-6989586621679171862"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; IO ()
</span><a href="#local-6989586621679171924"><span class="hs-identifier hs-var">printN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171862"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171869"><span class="hs-identifier hs-var">clampY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; IO ()) -&gt; Double -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171980"><span class="hs-identifier hs-var">ux</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171862"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-237"></span><span>            </span><span id="local-6989586621679171858"><span class="annot"><span class="annottext">horN :: Double -&gt; IO ()
</span><a href="#local-6989586621679171858"><span class="hs-identifier hs-var hs-var">horN</span></a></span></span><span> </span><span id="local-6989586621679171857"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171857"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; IO ()
</span><a href="#local-6989586621679171924"><span class="hs-identifier hs-var">printN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171882"><span class="hs-identifier hs-var">clampX</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171857"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171857"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; IO ()) -&gt; Double -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171979"><span class="hs-identifier hs-var">uy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171857"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-238"></span><span>            </span><span id="local-6989586621679171853"><span class="annot"><span class="annottext">horN' :: Double -&gt; IO ()
</span><a href="#local-6989586621679171853"><span class="hs-identifier hs-var hs-var">horN'</span></a></span></span><span> </span><span id="local-6989586621679171852"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171852"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171852"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171858"><span class="hs-identifier hs-var">horN</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171852"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679171846"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171845"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171984"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171983"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>            </span><span id="local-6989586621679171839"><span class="annot"><span class="annottext">ovx :: Double
</span><a href="#local-6989586621679171839"><span class="hs-identifier hs-var hs-var">ovx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171984"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171978"><span class="hs-identifier hs-var">vs</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171978"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span id="local-6989586621679171833"><span class="annot"><span class="annottext">ovy :: Double
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var hs-var">ovy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171983"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171977"><span class="hs-identifier hs-var">hs</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171977"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-242"></span><span>            </span><span id="local-6989586621679171830"><span class="annot"><span class="annottext">ovx1 :: Double
</span><a href="#local-6989586621679171830"><span class="hs-identifier hs-var hs-var">ovx1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span id="local-6989586621679171827"><span class="annot"><span class="annottext">ovy1 :: Double
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var hs-var">ovy1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphCfg -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphCfg.html#_gcHideMinor"><span class="hs-identifier hs-var hs-var">_gcHideMinor</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-245"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">drawInAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171839"><span class="hs-identifier hs-var">ovx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171839"><span class="hs-identifier hs-var">ovx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171978"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171908"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-247"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171839"><span class="hs-identifier hs-var">ovx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171839"><span class="hs-identifier hs-var">ovx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171978"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171908"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-248"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var">ovy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var">ovy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171977"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171905"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-249"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var">ovy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var">ovy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171977"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171905"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">drawInAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171830"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171830"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171908"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-252"></span><span>            </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171830"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171830"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171911"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171988"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171986"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171908"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-253"></span><span>            </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171905"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-254"></span><span>            </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171910"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171987"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171985"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171905"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679171814"><span class="annot"><span class="annottext">p :: (Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679171814"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171813"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171813"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171812"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171812"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171982"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171813"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171968"><span class="hs-identifier hs-var">ox</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171981"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171812"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171967"><span class="hs-identifier hs-var">oy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">[GraphData] -&gt; (GraphData -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[GraphData]
</span><a href="#local-6989586621679172335"><span class="hs-identifier hs-var">graphDatas</span></a></span><span> </span><span class="annot"><span class="annottext">((GraphData -&gt; IO ()) -&gt; IO ()) -&gt; (GraphData -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679171811"><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171811"><span class="hs-identifier hs-var">graphData</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679171809"><span class="annot"><span class="annottext">ps :: [(Double, Double)]
</span><a href="#local-6989586621679171809"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679171814"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; (Double, Double))
-&gt; [(Double, Double)] -&gt; [(Double, Double)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; [(Double, Double)]
</span><a href="Monomer.Graph.GraphData.html#_gdPoints"><span class="hs-identifier hs-var hs-var">_gdPoints</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171811"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-258"></span><span>                </span><span id="local-6989586621679171807"><span class="annot"><span class="annottext">newGraphData :: GraphData
</span><a href="#local-6989586621679171807"><span class="hs-identifier hs-var hs-var">newGraphData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171811"><span class="hs-identifier hs-var">graphData</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gdPoints :: [(Double, Double)]
</span><a href="Monomer.Graph.GraphData.html#_gdPoints"><span class="hs-identifier hs-var">_gdPoints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171809"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Color -&gt; Bool) -&gt; Maybe Color -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; Maybe Color
</span><a href="Monomer.Graph.GraphData.html#_gdColor"><span class="hs-identifier hs-var hs-var">_gdColor</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171811"><span class="hs-identifier hs-var">graphData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-260"></span><span>                </span><span class="annot"><span class="annottext">Renderer -&gt; GraphData -&gt; IO ()
</span><a href="#local-6989586621679171804"><span class="hs-identifier hs-var">renderGraphData</span></a></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171807"><span class="hs-identifier hs-var">newGraphData</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphCfg -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphCfg.html#_gcHideNumbers"><span class="hs-identifier hs-var hs-var">_gcHideNumbers</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Color -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">setFillColor</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span>
</span><span id="line-263"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">drawInAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.62</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171863"><span class="hs-identifier hs-var">verN</span></a></span><span>
</span><span id="line-265"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171846"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171863"><span class="hs-identifier hs-var">verN</span></a></span><span>
</span><span id="line-266"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171853"><span class="hs-identifier hs-var">horN'</span></a></span><span>
</span><span id="line-267"></span><span>                </span><span class="annot"><span class="annottext">[Double] -&gt; (Double -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171845"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679171853"><span class="hs-identifier hs-var">horN'</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">restoreContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171991"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679171804"><span class="annot"><span class="annottext">renderGraphData :: Renderer -&gt; GraphData -&gt; IO ()
</span><a href="#local-6989586621679171804"><span class="hs-identifier hs-var hs-var">renderGraphData</span></a></span></span><span> </span><span id="local-6989586621679171768"><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span></span><span> </span><span id="local-6989586621679171767"><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679171766"><span class="annot"><span class="annottext">ps :: [(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; [(Double, Double)]
</span><a href="Monomer.Graph.GraphData.html#_gdPoints"><span class="hs-identifier hs-var hs-var">_gdPoints</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-272"></span><span>            </span><span id="local-6989586621679171765"><span class="annot"><span class="annottext">c :: Maybe Color
</span><a href="#local-6989586621679171765"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; Maybe Color
</span><a href="Monomer.Graph.GraphData.html#_gdColor"><span class="hs-identifier hs-var hs-var">_gdColor</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span id="local-6989586621679171763"><span class="annot"><span class="annottext">w :: Double
</span><a href="#local-6989586621679171763"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Maybe Double -&gt; Double
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Double) -&gt; Maybe Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; Maybe Double
</span><a href="Monomer.Graph.GraphData.html#_gdWidth"><span class="hs-identifier hs-var hs-var">_gdWidth</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-274"></span><span>            </span><span id="local-6989586621679171760"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679171760"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Maybe Double -&gt; Double
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.32</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Double) -&gt; Maybe Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; Maybe Double
</span><a href="Monomer.Graph.GraphData.html#_gdFillAlpha"><span class="hs-identifier hs-var hs-var">_gdFillAlpha</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-275"></span><span>            </span><span id="local-6989586621679171758"><span class="annot"><span class="annottext">p :: (Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171757"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171757"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171756"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171756"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171757"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171756"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-276"></span><span>            </span><span id="local-6989586621679171755"><span class="annot"><span class="annottext">connect :: ((Double, Double), (Double, Double)) -&gt; IO ()
</span><a href="#local-6989586621679171755"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171754"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679171754"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679171753"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679171753"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; Point -&gt; Double -&gt; Maybe Color -&gt; IO ()
</span><span class="hs-identifier hs-var">drawLine</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679171754"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679171753"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171763"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679171765"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-277"></span><span>            </span><span id="local-6989586621679171752"><span class="annot"><span class="annottext">drawDot :: Point -&gt; IO ()
</span><a href="#local-6989586621679171752"><span class="hs-identifier hs-var hs-var">drawDot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679171751"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171751"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679171750"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171750"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Rect -&gt; Maybe Color -&gt; IO ()
</span><span class="hs-identifier hs-var">drawEllipse</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679171748"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679171765"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>                </span><span id="local-6989586621679171748"><span class="annot"><span class="annottext">el :: Rect
</span><a href="#local-6989586621679171748"><span class="hs-identifier hs-var hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Rect
</span><span class="hs-identifier hs-var">Rect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171751"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171763"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171750"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171763"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171763"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171763"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>            </span><span id="local-6989586621679171736"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679171736"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GraphData -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphData.html#_gdSeparate"><span class="hs-identifier hs-var hs-var">_gdSeparate</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-281"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; ((Double, Double) -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double) -&gt; IO ()) -&gt; IO ())
-&gt; ((Double, Double) -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; IO ()
</span><a href="#local-6989586621679171752"><span class="hs-identifier hs-var">drawDot</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; IO ())
-&gt; ((Double, Double) -&gt; Point) -&gt; (Double, Double) -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171736"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
-&gt; (((Double, Double), (Double, Double)) -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Double, Double)]
-&gt; [(Double, Double)] -&gt; [((Double, Double), (Double, Double))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; [(Double, Double)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Double, Double), (Double, Double)) -&gt; IO ()
</span><a href="#local-6989586621679171755"><span class="hs-identifier hs-var">connect</span></a></span><span>
</span><span id="line-284"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171736"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; IO ()
</span><a href="#local-6989586621679171752"><span class="hs-identifier hs-var">drawDot</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; IO ()) -&gt; Point -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Point) -&gt; (Double, Double) -&gt; Point
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; (Double, Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphData -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphData.html#_gdFill"><span class="hs-identifier hs-var hs-var">_gdFill</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData
</span><a href="#local-6989586621679171767"><span class="hs-identifier hs-var">graphData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171736"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">beginPath</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">moveTo</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; IO ()) -&gt; Point -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Point) -&gt; (Double, Double) -&gt; Point
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; (Double, Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; ((Double, Double) -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; [(Double, Double)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Double, Double) -&gt; IO ()) -&gt; IO ())
-&gt; ((Double, Double) -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">renderLineTo</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; IO ())
-&gt; ((Double, Double) -&gt; Point) -&gt; (Double, Double) -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679171758"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">saveContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">setGlobalAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171760"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Color -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">setFillColor</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">(Color -&gt; IO ()) -&gt; Color -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color -&gt; Color
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679171765"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">fill</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var">restoreContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679171768"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="#local-6989586621679172127"><span class="hs-identifier hs-type">floor'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679172127"><span class="annot"><span class="annottext">floor' :: Double -&gt; Double
</span><a href="#local-6989586621679172127"><span class="hs-identifier hs-var hs-var">floor'</span></a></span></span><span> </span><span id="local-6989586621679171724"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171724"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171724"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="#local-6989586621679171933"><span class="hs-identifier hs-type">round'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679171933"><span class="annot"><span class="annottext">round' :: Double -&gt; Double
</span><a href="#local-6989586621679171933"><span class="hs-identifier hs-var hs-var">round'</span></a></span></span><span> </span><span id="local-6989586621679171722"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171722"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679171722"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679172304"><span class="annot"><span class="annottext">makeGraphWithState :: GraphState -&gt; Widget s e
</span><a href="#local-6989586621679172304"><span class="hs-identifier hs-var hs-var">makeGraphWithState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GraphData] -&gt; GraphCfg -&gt; GraphState -&gt; Widget s e
forall s e. [GraphData] -&gt; GraphCfg -&gt; GraphState -&gt; Widget s e
</span><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-var">makeGraph</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphData]
</span><a href="#local-6989586621679172335"><span class="hs-identifier hs-var">graphDatas</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg
</span><a href="#local-6989586621679172334"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-302"></span></pre></body></html>