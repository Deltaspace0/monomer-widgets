<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
This widget renders a Cartesian coordinate system and plots function
graphs by connecting provided points. Coordinate system can be
dragged and scaled. It is possible to render single points too.

This widget can receive 'GraphMsg' messages:

- 'GraphSetTranslation' 'Point'
- 'GraphSetScale' 'Point'
- 'GraphReset'

@
graph [[(1,2), (1,3)], [(0,0), (1,1)]]
graphWithColors [(red, [(1,2), (1,3)]), (blue, [(0,0), (1,1)])]
graphWithData [[graphPoint (0, 0), graphColor red]]
@
-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Monomer.Graph</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Re-exported modules</span></span><span>
</span><span id="line-24"></span><span>      </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html"><span class="hs-identifier">Monomer.Graph.GraphCfg</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphData.html"><span class="hs-identifier">Monomer.Graph.GraphData</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphMsg.html"><span class="hs-identifier">Monomer.Graph.GraphMsg</span></a></span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Constructors</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graph"><span class="hs-identifier">graph</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graph_"><span class="hs-identifier">graph_</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithColors"><span class="hs-identifier">graphWithColors</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier">graphWithColors_</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithData"><span class="hs-identifier">graphWithData</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier">graphWithData_</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Fixed</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Graphics.ColorTable</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Widgets.Single</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Monomer.Lens</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html"><span class="hs-identifier">Monomer.Graph.GraphCfg</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphData.html"><span class="hs-identifier">Monomer.Graph.GraphData</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphMsg.html"><span class="hs-identifier">Monomer.Graph.GraphMsg</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphState.html"><span class="hs-identifier">Monomer.Graph.GraphState</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with points.
-}</span><span>
</span><span id="line-57"></span><span id="local-6989586621679164640"><span id="local-6989586621679164642"><span class="annot"><a href="Monomer.Graph.html#graph"><span class="hs-identifier hs-type">graph</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164642"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The list with points.</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679164640"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164642"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>        </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-61"></span><span id="graph"><span class="annot"><span class="annottext">graph :: forall e s. WidgetEvent e =&gt; [[(Double, Double)]] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graph"><span class="hs-identifier hs-var hs-var">graph</span></a></span></span><span> </span><span id="local-6989586621679164417"><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679164417"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[[(Double, Double)]] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graph_"><span class="hs-identifier hs-var">graph_</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679164417"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with points. Accepts config.
-}</span><span>
</span><span id="line-66"></span><span id="local-6989586621679164632"><span id="local-6989586621679164633"><span class="annot"><a href="Monomer.Graph.html#graph_"><span class="hs-identifier hs-type">graph_</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164633"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The list with points.</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164632"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164633"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ The config options.</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679164632"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164633"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>        </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-71"></span><span id="graph_"><span class="annot"><span class="annottext">graph_ :: forall e s.
WidgetEvent e =&gt;
[[(Double, Double)]] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graph_"><span class="hs-identifier hs-var hs-var">graph_</span></a></span></span><span> </span><span id="local-6989586621679164413"><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679164413"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span id="local-6989586621679164412"><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164412"><span class="hs-identifier hs-var">configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[(Color, [(Double, Double)])] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-var">graphWithColors_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679164411"><span class="hs-identifier hs-var">colorPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164412"><span class="hs-identifier hs-var">configs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679164411"><span class="annot"><span class="annottext">colorPoints :: [(Color, [(Double, Double)])]
</span><a href="#local-6989586621679164411"><span class="hs-identifier hs-var hs-var">colorPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Color]
</span><a href="#local-6989586621679164409"><span class="hs-identifier hs-var">colors'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679164413"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679164409"><span class="annot"><span class="annottext">colors' :: [Color]
</span><a href="#local-6989586621679164409"><span class="hs-identifier hs-var hs-var">colors'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[Color]
</span><a href="#local-6989586621679164407"><span class="hs-identifier hs-var">colors</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Color]
</span><a href="#local-6989586621679164406"><span class="hs-identifier hs-var">_gcGraphColors</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679164407"><span class="annot"><span class="annottext">colors :: [Color]
</span><a href="#local-6989586621679164407"><span class="hs-identifier hs-var hs-var">colors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">red</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">green</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">blue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">violet</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">yellow</span></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span class="hs-special">{</span><span id="local-6989586621679164383"><span id="local-6989586621679164384"><span id="local-6989586621679164385"><span id="local-6989586621679164386"><span id="local-6989586621679164387"><span id="local-6989586621679164388"><span id="local-6989586621679164389"><span id="local-6989586621679164390"><span id="local-6989586621679164391"><span id="local-6989586621679164392"><span id="local-6989586621679164393"><span id="local-6989586621679164394"><span id="local-6989586621679164395"><span id="local-6989586621679164396"><span id="local-6989586621679164397"><span id="local-6989586621679164406"><span class="annot"><span class="annottext">[(Double, Double) -&gt; WidgetRequest s e]
Maybe Bool
Maybe Double
Maybe [Color]
_gcOnRightClickReq :: forall s e. GraphCfg s e -&gt; [(Double, Double) -&gt; WidgetRequest s e]
_gcGraphColors :: forall s e. GraphCfg s e -&gt; Maybe [Color]
_gcHideGrid :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcHideNumbers :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcHideMinor :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcLockY :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcLockX :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcMaxScaleY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinScaleY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMaxScaleX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinScaleX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMaxY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMaxX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcWheelRate :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcOnRightClickReq :: [(Double, Double) -&gt; WidgetRequest s e]
_gcHideGrid :: Maybe Bool
_gcHideNumbers :: Maybe Bool
_gcHideMinor :: Maybe Bool
_gcLockY :: Maybe Bool
_gcLockX :: Maybe Bool
_gcMaxScaleY :: Maybe Double
_gcMinScaleY :: Maybe Double
_gcMaxScaleX :: Maybe Double
_gcMinScaleX :: Maybe Double
_gcMaxY :: Maybe Double
_gcMinY :: Maybe Double
_gcMaxX :: Maybe Double
_gcMinX :: Maybe Double
_gcWheelRate :: Maybe Double
_gcGraphColors :: Maybe [Color]
</span><a href="Monomer.Graph.GraphCfg.html#_gcOnRightClickReq"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164412"><span class="hs-identifier hs-var">configs</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with colors and points.
-}</span><span>
</span><span id="line-80"></span><span id="local-6989586621679164614"><span id="local-6989586621679164615"><span class="annot"><a href="Monomer.Graph.html#graphWithColors"><span class="hs-identifier hs-type">graphWithColors</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164615"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- ^ The list with colors and points.</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679164614"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164615"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-86"></span><span id="graphWithColors"><span class="annot"><span class="annottext">graphWithColors :: forall e s.
WidgetEvent e =&gt;
[(Color, [(Double, Double)])] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors"><span class="hs-identifier hs-var hs-var">graphWithColors</span></a></span></span><span> </span><span id="local-6989586621679164363"><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679164363"><span class="hs-identifier hs-var">colorPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[(Color, [(Double, Double)])] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-var">graphWithColors_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679164363"><span class="hs-identifier hs-var">colorPoints</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with colors and points.
Accepts config.
-}</span><span>
</span><span id="line-92"></span><span id="local-6989586621679164626"><span id="local-6989586621679164628"><span class="annot"><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-type">graphWithColors_</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164628"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- ^ The list with colors and points.</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164626"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164628"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- ^ The config options.</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679164626"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164628"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-100"></span><span id="graphWithColors_"><span class="annot"><span class="annottext">graphWithColors_ :: forall e s.
WidgetEvent e =&gt;
[(Color, [(Double, Double)])] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithColors_"><span class="hs-identifier hs-var hs-var">graphWithColors_</span></a></span></span><span> </span><span id="local-6989586621679164361"><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679164361"><span class="hs-identifier hs-var">colorPoints</span></a></span></span><span> </span><span id="local-6989586621679164360"><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164360"><span class="hs-identifier hs-var">configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164359"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679164359"><span class="annot"><span class="annottext">node :: WidgetNode s e
</span><a href="#local-6989586621679164359"><span class="hs-identifier hs-var hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[[GraphData s e]] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-var">graphWithData_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {s} {e}. (Color, [(Double, Double)]) -&gt; [GraphData s e]
</span><a href="#local-6989586621679164355"><span class="hs-identifier hs-var">makeData</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Color, [(Double, Double)])]
</span><a href="#local-6989586621679164361"><span class="hs-identifier hs-var">colorPoints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164360"><span class="hs-identifier hs-var">configs</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679164355"><span class="annot"><span class="annottext">makeData :: (Color, [(Double, Double)]) -&gt; [GraphData s e]
</span><a href="#local-6989586621679164355"><span class="hs-identifier hs-var hs-var">makeData</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164353"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679164353"><span class="hs-identifier hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164352"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679164352"><span class="hs-identifier hs-var">points</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall s e. [(Double, Double)] -&gt; GraphData s e
</span><a href="Monomer.Graph.GraphData.html#graphPoints"><span class="hs-identifier hs-var">graphPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679164352"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall s e. Color -&gt; GraphData s e
</span><a href="Monomer.Graph.GraphData.html#graphColor"><span class="hs-identifier hs-var">graphColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679164353"><span class="hs-identifier hs-var">color</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with 'GraphData'.
-}</span><span>
</span><span id="line-110"></span><span id="local-6989586621679164596"><span id="local-6989586621679164597"><span class="annot"><a href="Monomer.Graph.html#graphWithData"><span class="hs-identifier hs-type">graphWithData</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164597"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164597"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The list with 'GraphData'.</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679164596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164597"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>     </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-114"></span><span id="graphWithData"><span class="annot"><span class="annottext">graphWithData :: forall e s. WidgetEvent e =&gt; [[GraphData s e]] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData"><span class="hs-identifier hs-var hs-var">graphWithData</span></a></span></span><span> </span><span id="local-6989586621679164346"><span class="annot"><span class="annottext">[[GraphData s e]]
</span><a href="#local-6989586621679164346"><span class="hs-identifier hs-var">dataList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[[GraphData s e]] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-var">graphWithData_</span></a></span><span> </span><span class="annot"><span class="annottext">[[GraphData s e]]
</span><a href="#local-6989586621679164346"><span class="hs-identifier hs-var">dataList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">{-|
Creates a graph plotter using the list with 'GraphData'. Accepts
config.
-}</span><span>
</span><span id="line-120"></span><span id="local-6989586621679164608"><span id="local-6989586621679164609"><span class="annot"><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-type">graphWithData_</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164609"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164608"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164609"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The list with 'GraphData'.</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164608"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164609"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ The config options.</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WidgetNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679164608"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164609"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>     </span><span class="hs-comment">-- ^ The created graph plotter.</span><span>
</span><span id="line-125"></span><span id="graphWithData_"><span class="annot"><span class="annottext">graphWithData_ :: forall e s.
WidgetEvent e =&gt;
[[GraphData s e]] -&gt; [GraphCfg s e] -&gt; WidgetNode s e
</span><a href="Monomer.Graph.html#graphWithData_"><span class="hs-identifier hs-var hs-var">graphWithData_</span></a></span></span><span> </span><span id="local-6989586621679164344"><span class="annot"><span class="annottext">[[GraphData s e]]
</span><a href="#local-6989586621679164344"><span class="hs-identifier hs-var">dataList</span></a></span></span><span> </span><span id="local-6989586621679164343"><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164343"><span class="hs-identifier hs-var">configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164342"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679164342"><span class="annot"><span class="annottext">node :: WidgetNode s e
</span><a href="#local-6989586621679164342"><span class="hs-identifier hs-var hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetType -&gt; Widget s e -&gt; WidgetNode s e
</span><span class="hs-identifier hs-var">defaultWidgetNode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; WidgetType
</span><span class="hs-identifier hs-var">WidgetType</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;graph&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Widget s e
</span><a href="#local-6989586621679164337"><span class="hs-identifier hs-var">widget</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679164337"><span class="annot"><span class="annottext">widget :: Widget s e
</span><a href="#local-6989586621679164337"><span class="hs-identifier hs-var hs-var">widget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[GraphData s e] -&gt; GraphCfg s e -&gt; GraphState -&gt; Widget s e
</span><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-var">makeGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[GraphData s e]]
</span><a href="#local-6989586621679164344"><span class="hs-identifier hs-var">dataList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphCfg s e
</span><a href="#local-6989586621679164329"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679164329"><span class="annot"><span class="annottext">config :: GraphCfg s e
</span><a href="#local-6989586621679164329"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[GraphCfg s e]
</span><a href="#local-6989586621679164343"><span class="hs-identifier hs-var">configs</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679164582"><span id="local-6989586621679164583"><span class="annot"><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-type">makeGraph</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WidgetEvent</span></span><span> </span><span class="annot"><a href="#local-6989586621679164583"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164583"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164583"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphState.html#GraphState"><span class="hs-identifier hs-type">GraphState</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Widget</span></span><span> </span><span class="annot"><a href="#local-6989586621679164582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164583"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-136"></span><span id="makeGraph"><span class="annot"><span class="annottext">makeGraph :: forall e s.
WidgetEvent e =&gt;
[GraphData s e] -&gt; GraphCfg s e -&gt; GraphState -&gt; Widget s e
</span><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-var hs-var">makeGraph</span></a></span></span><span> </span><span id="local-6989586621679164315"><span class="annot"><span class="annottext">[GraphData s e]
</span><a href="#local-6989586621679164315"><span class="hs-identifier hs-var">graphDatas</span></a></span></span><span> </span><span id="local-6989586621679164314"><span class="annot"><span class="annottext">config :: GraphCfg s e
</span><a href="#local-6989586621679164314"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Monomer.Graph.GraphCfg.html#GraphCfg"><span class="hs-identifier hs-type">GraphCfg</span></a></span><span class="hs-special">{</span><span id="local-6989586621679164298"><span id="local-6989586621679164299"><span id="local-6989586621679164300"><span id="local-6989586621679164301"><span id="local-6989586621679164302"><span id="local-6989586621679164303"><span id="local-6989586621679164304"><span id="local-6989586621679164305"><span id="local-6989586621679164306"><span id="local-6989586621679164307"><span id="local-6989586621679164308"><span id="local-6989586621679164309"><span id="local-6989586621679164310"><span id="local-6989586621679164311"><span id="local-6989586621679164312"><span id="local-6989586621679164313"><span class="annot"><span class="annottext">[(Double, Double) -&gt; WidgetRequest s e]
Maybe Bool
Maybe Double
Maybe [Color]
_gcOnRightClickReq :: [(Double, Double) -&gt; WidgetRequest s e]
_gcGraphColors :: Maybe [Color]
_gcHideGrid :: Maybe Bool
_gcHideNumbers :: Maybe Bool
_gcHideMinor :: Maybe Bool
_gcLockY :: Maybe Bool
_gcLockX :: Maybe Bool
_gcMaxScaleY :: Maybe Double
_gcMinScaleY :: Maybe Double
_gcMaxScaleX :: Maybe Double
_gcMinScaleX :: Maybe Double
_gcMaxY :: Maybe Double
_gcMinY :: Maybe Double
_gcMaxX :: Maybe Double
_gcMinX :: Maybe Double
_gcWheelRate :: Maybe Double
_gcOnRightClickReq :: forall s e. GraphCfg s e -&gt; [(Double, Double) -&gt; WidgetRequest s e]
_gcGraphColors :: forall s e. GraphCfg s e -&gt; Maybe [Color]
_gcHideGrid :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcHideNumbers :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcHideMinor :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcLockY :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcLockX :: forall s e. GraphCfg s e -&gt; Maybe Bool
_gcMaxScaleY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinScaleY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMaxScaleX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinScaleX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMaxY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinY :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMaxX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcMinX :: forall s e. GraphCfg s e -&gt; Maybe Double
_gcWheelRate :: forall s e. GraphCfg s e -&gt; Maybe Double
</span><a href="#local-6989586621679164298"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679164297"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164297"><span class="hs-identifier hs-var">orState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget s e
</span><a href="#local-6989586621679164296"><span class="hs-identifier hs-var">widget</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679164296"><span class="annot"><span class="annottext">widget :: Widget s e
</span><a href="#local-6989586621679164296"><span class="hs-identifier hs-var hs-var">widget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a s e. WidgetModel a =&gt; a -&gt; Single s e a -&gt; Widget s e
</span><span class="hs-identifier hs-var">createSingle</span></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">singleGetCurrentStyle :: SingleGetCurrentStyle s e
</span><span class="hs-identifier hs-var">singleGetCurrentStyle</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}. WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><a href="#local-6989586621679164289"><span class="hs-identifier hs-var">getCurrentStyle</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleInit :: SingleInitHandler s e
</span><span class="hs-identifier hs-var">singleInit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleInitHandler s e
</span><a href="#local-6989586621679164287"><span class="hs-identifier hs-var">init'</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleMerge :: SingleMergeHandler s e GraphState
</span><span class="hs-identifier hs-var">singleMerge</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {p} {p}.
p -&gt; WidgetNode s e -&gt; p -&gt; GraphState -&gt; WidgetResult s e
</span><a href="#local-6989586621679164285"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleHandleEvent :: SingleEventHandler s e
</span><span class="hs-identifier hs-var">singleHandleEvent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {p}.
WidgetEnv s e
-&gt; WidgetNode s e -&gt; p -&gt; SystemEvent -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164283"><span class="hs-identifier hs-var">handleEvent</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleHandleMessage :: SingleMessageHandler s e
</span><span class="hs-identifier hs-var">singleHandleMessage</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {p} {p}.
Typeable a =&gt;
p -&gt; WidgetNode s e -&gt; p -&gt; a -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164281"><span class="hs-identifier hs-var">handleMessage</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleGetSizeReq :: SingleGetSizeReqHandler s e
</span><span class="hs-identifier hs-var">singleGetSizeReq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {p} {p}. p -&gt; p -&gt; (SizeReq, SizeReq)
</span><a href="#local-6989586621679164277"><span class="hs-identifier hs-var">getSizeReq</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleResize :: SingleResizeHandler s e
</span><span class="hs-identifier hs-var">singleResize</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {p}. p -&gt; WidgetNode s e -&gt; Rect -&gt; WidgetResult s e
</span><a href="#local-6989586621679164275"><span class="hs-identifier hs-var">resize</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">singleRender :: SingleRenderHandler s e
</span><span class="hs-identifier hs-var">singleRender</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}.
WidgetEnv s e -&gt; WidgetNode s e -&gt; Renderer -&gt; IO ()
</span><a href="#local-6989586621679164273"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679164289"><span class="annot"><span class="annottext">getCurrentStyle :: WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><a href="#local-6989586621679164289"><span class="hs-identifier hs-var hs-var">getCurrentStyle</span></a></span></span><span> </span><span id="local-6989586621679164272"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164272"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679164271"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164271"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679164270"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621679164270"><span class="annot"><span class="annottext">style :: StyleState
</span><a href="#local-6989586621679164270"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}. WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><span class="hs-identifier hs-var">currentStyle</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164272"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164271"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall s a. HasCursorIcon s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.cursorIcon</span></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe CursorIcon
</span><a href="#local-6989586621679164261"><span class="hs-identifier hs-var">cursor</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679164261"><span class="annot"><span class="annottext">cursor :: Maybe CursorIcon
</span><a href="#local-6989586621679164261"><span class="hs-identifier hs-var hs-var">cursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphState -&gt; Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsHoverPoint"><span class="hs-identifier hs-var">_gsHoverPoint</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CursorIcon
</span><span class="hs-identifier hs-var">CursorHand</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679164287"><span class="annot"><span class="annottext">init' :: SingleInitHandler s e
</span><a href="#local-6989586621679164287"><span class="hs-identifier hs-var hs-var">init'</span></a></span></span><span> </span><span id="local-6989586621679164255"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164255"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679164254"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164254"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetNode s e -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultNode</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164252"><span class="hs-identifier hs-var">resNode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>        </span><span id="local-6989586621679164252"><span class="annot"><span class="annottext">resNode :: WidgetNode s e
</span><a href="#local-6989586621679164252"><span class="hs-identifier hs-var hs-var">resNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164248"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164254"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621679164248"><span class="annot"><span class="annottext">newState :: GraphState
</span><a href="#local-6989586621679164248"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164297"><span class="hs-identifier hs-var">orState</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsViewport :: Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679164246"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679164246"><span class="annot"><span class="annottext">vp :: Rect
</span><a href="#local-6989586621679164246"><span class="hs-identifier hs-var hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetNode s e -&gt; StyleState -&gt; Rect
</span><span class="hs-identifier hs-var">getContentArea</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164254"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679164244"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621679164244"><span class="annot"><span class="annottext">style :: StyleState
</span><a href="#local-6989586621679164244"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}. WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><span class="hs-identifier hs-var">currentStyle</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164255"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164254"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679164285"><span class="annot"><span class="annottext">merge :: p -&gt; WidgetNode s e -&gt; p -&gt; GraphState -&gt; WidgetResult s e
</span><a href="#local-6989586621679164285"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679164243"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164243"><span class="hs-identifier hs-var">newNode</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679164242"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164242"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetNode s e -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultNode</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164241"><span class="hs-identifier hs-var">resNode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679164241"><span class="annot"><span class="annottext">resNode :: WidgetNode s e
</span><a href="#local-6989586621679164241"><span class="hs-identifier hs-var hs-var">resNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164242"><span class="hs-identifier hs-var">oldState</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164243"><span class="hs-identifier hs-var">newNode</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679164283"><span class="annot"><span class="annottext">handleEvent :: WidgetEnv s e
-&gt; WidgetNode s e -&gt; p -&gt; SystemEvent -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164283"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span id="local-6989586621679164239"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164239"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679164238"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164238"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679164237"><span class="annot"><span class="annottext">SystemEvent
</span><a href="#local-6989586621679164237"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164236"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>        </span><span id="local-6989586621679164236"><span class="annot"><span class="annottext">result :: Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164236"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SystemEvent
</span><a href="#local-6989586621679164237"><span class="hs-identifier hs-var">event</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">ButtonAction</span></span><span> </span><span id="local-6989586621679164234"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164234"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ButtonState
</span><span class="hs-identifier hs-var">BtnPressed</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164232"><span class="hs-identifier hs-var">resultPressed</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164234"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">ButtonAction</span></span><span> </span><span id="local-6989586621679164231"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164231"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier hs-var">BtnRight</span></span><span> </span><span class="annot"><span class="annottext">ButtonState
</span><span class="hs-identifier hs-var">BtnReleased</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164228"><span class="hs-identifier hs-var">resultRight</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164231"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-167"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">ButtonAction</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ButtonState
</span><span class="hs-identifier hs-var">BtnReleased</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164227"><span class="hs-identifier hs-var">handleReleased</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164238"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Move</span></span><span> </span><span id="local-6989586621679164225"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164225"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
-&gt; WidgetNode s e -&gt; Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164224"><span class="hs-identifier hs-var">handleMove</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164239"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164238"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164225"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">WheelScroll</span></span><span> </span><span id="local-6989586621679164222"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164222"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679164220"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164220"><span class="hs-identifier hs-var">wy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WheelDirection
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164219"><span class="hs-identifier hs-var">resultScroll</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164222"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164220"><span class="hs-identifier hs-var">wy</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><span class="annottext">SystemEvent
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-171"></span><span>        </span><span id="local-6989586621679164228"><span class="annot"><span class="annottext">resultRight :: Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164228"><span class="hs-identifier hs-var hs-var">resultRight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164218"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164218"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679164217"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164217"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">WidgetResult s e
</span><a href="#local-6989586621679164216"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>            </span><span id="local-6989586621679164216"><span class="annot"><span class="annottext">res :: WidgetResult s e
</span><a href="#local-6989586621679164216"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164238"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679164213"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double) -&gt; WidgetRequest s e]
</span><a href="#local-6989586621679164298"><span class="hs-identifier hs-var">_gcOnRightClickReq</span></a></span><span>
</span><span id="line-173"></span><span>            </span><span id="local-6989586621679164213"><span class="annot"><span class="annottext">p' :: (Double, Double)
</span><a href="#local-6989586621679164213"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164218"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164203"><span class="hs-identifier hs-var">ox</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164201"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164200"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164217"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164199"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>        </span><span id="local-6989586621679164232"><span class="annot"><span class="annottext">resultPressed :: Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164232"><span class="hs-identifier hs-var hs-var">resultPressed</span></a></span></span><span> </span><span id="local-6989586621679164198"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164198"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}. WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164197"><span class="hs-identifier hs-var">resultRender</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679164196"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsMousePosition :: Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164198"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsActivePoint :: Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsActivePoint"><span class="hs-identifier hs-var">_gsActivePoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsHoverPoint"><span class="hs-identifier hs-var">_gsHoverPoint</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>        </span><span id="local-6989586621679164219"><span class="annot"><span class="annottext">resultScroll :: Point -&gt; Double -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164219"><span class="hs-identifier hs-var hs-var">resultScroll</span></a></span></span><span> </span><span id="local-6989586621679164193"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164193"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}. WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164197"><span class="hs-identifier hs-var">resultRender</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; WidgetNode s e
</span><a href="#local-6989586621679164191"><span class="hs-identifier hs-var">newScroll</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164193"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span id="local-6989586621679164191"><span class="annot"><span class="annottext">newScroll :: Point -&gt; Double -&gt; WidgetNode s e
</span><a href="#local-6989586621679164191"><span class="hs-identifier hs-var hs-var">newScroll</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164182"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164182"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679164181"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164181"><span class="hs-identifier hs-var">my</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679164180"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164180"><span class="hs-identifier hs-var">wy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679164196"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164178"><span class="hs-identifier hs-var">tx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164177"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-181"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsScale :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164175"><span class="hs-identifier hs-var">cx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164174"><span class="hs-identifier hs-var">cy'</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsUnit :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsUnit"><span class="hs-identifier hs-var">_gsUnit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164172"><span class="hs-identifier hs-var">ux</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164171"><span class="hs-identifier hs-var">uy</span></a></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsSections :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsSections"><span class="hs-identifier hs-var">_gsSections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a} {a}. (Num a, Floating a, Real a) =&gt; a -&gt; a
</span><a href="#local-6989586621679164169"><span class="hs-identifier hs-var">getSec</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164175"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a} {a}. (Num a, Floating a, Real a) =&gt; a -&gt; a
</span><a href="#local-6989586621679164169"><span class="hs-identifier hs-var">getSec</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164174"><span class="hs-identifier hs-var">cy'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>            </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>                </span><span id="local-6989586621679164178"><span class="annot"><span class="annottext">tx' :: Double
</span><a href="#local-6989586621679164178"><span class="hs-identifier hs-var hs-var">tx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164164"><span class="hs-identifier hs-var">mx'</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164164"><span class="hs-identifier hs-var">mx'</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164163"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164175"><span class="hs-identifier hs-var">cx'</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164201"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-186"></span><span>                </span><span id="local-6989586621679164177"><span class="annot"><span class="annottext">ty' :: Double
</span><a href="#local-6989586621679164177"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164157"><span class="hs-identifier hs-var">my'</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164157"><span class="hs-identifier hs-var">my'</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164156"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164174"><span class="hs-identifier hs-var">cy'</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164199"><span class="hs-identifier hs-var">cy</span></a></span><span>
</span><span id="line-187"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679164164"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164164"><span class="hs-identifier hs-var">mx'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164157"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164157"><span class="hs-identifier hs-var">my'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164182"><span class="hs-identifier hs-var">mx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164147"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164146"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164181"><span class="hs-identifier hs-var">my</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164145"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164144"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679164172"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164172"><span class="hs-identifier hs-var">ux</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164171"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164171"><span class="hs-identifier hs-var">uy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679164143"><span class="hs-identifier hs-var">getUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164175"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679164143"><span class="hs-identifier hs-var">getUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164174"><span class="hs-identifier hs-var">cy'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679164175"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164175"><span class="hs-identifier hs-var">cx'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164174"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164174"><span class="hs-identifier hs-var">cy'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; (Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679164142"><span class="hs-identifier hs-var">clampScale</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164146"><span class="hs-identifier hs-var">gw</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164144"><span class="hs-identifier hs-var">gh</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679164141"><span class="hs-identifier hs-var">newScale</span></a></span><span>
</span><span id="line-190"></span><span>                </span><span id="local-6989586621679164141"><span class="annot"><span class="annottext">newScale :: (Double, Double)
</span><a href="#local-6989586621679164141"><span class="hs-identifier hs-var hs-var">newScale</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164201"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164136"><span class="hs-identifier hs-var">rateX</span></a></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164180"><span class="hs-identifier hs-var">wy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164199"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164134"><span class="hs-identifier hs-var">rateY</span></a></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164180"><span class="hs-identifier hs-var">wy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                </span><span id="local-6989586621679164136"><span class="annot"><span class="annottext">rateX :: Double
</span><a href="#local-6989586621679164136"><span class="hs-identifier hs-var hs-var">rateX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164304"><span class="hs-identifier hs-var">_gcLockX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-192"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-193"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.05</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164126"><span class="hs-identifier hs-var">wr</span></a></span><span>
</span><span id="line-194"></span><span>                </span><span id="local-6989586621679164134"><span class="annot"><span class="annottext">rateY :: Double
</span><a href="#local-6989586621679164134"><span class="hs-identifier hs-var hs-var">rateY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164303"><span class="hs-identifier hs-var">_gcLockY</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-195"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-196"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.05</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164126"><span class="hs-identifier hs-var">wr</span></a></span><span>
</span><span id="line-197"></span><span>                </span><span id="local-6989586621679164126"><span class="annot"><span class="annottext">wr :: Double
</span><a href="#local-6989586621679164126"><span class="hs-identifier hs-var hs-var">wr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164313"><span class="hs-identifier hs-var">_gcWheelRate</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679164203"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164203"><span class="hs-identifier hs-var">ox</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164200"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164200"><span class="hs-identifier hs-var">oy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164147"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164146"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164163"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164145"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164144"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164156"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Rect</span></span><span> </span><span id="local-6989586621679164147"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164147"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679164145"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164145"><span class="hs-identifier hs-var">gy</span></a></span></span><span> </span><span id="local-6989586621679164146"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164146"><span class="hs-identifier hs-var">gw</span></a></span></span><span> </span><span id="local-6989586621679164144"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164144"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span id="local-6989586621679164169"><span class="annot"><span class="annottext">getSec :: a -&gt; a
</span><a href="#local-6989586621679164169"><span class="hs-identifier hs-var hs-var">getSec</span></a></span></span><span> </span><span id="local-6989586621679164098"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164098"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164091"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679164091"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Real a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164098"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-201"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164091"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">4</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span>
</span><span id="line-202"></span><span>        </span><span id="local-6989586621679164143"><span class="annot"><span class="annottext">getUnit :: Double -&gt; Double
</span><a href="#local-6989586621679164143"><span class="hs-identifier hs-var hs-var">getUnit</span></a></span></span><span> </span><span id="local-6989586621679164077"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164077"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-203"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164076"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164075"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-204"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164076"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164075"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-205"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164075"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>                </span><span id="local-6989586621679164076"><span class="annot"><span class="annottext">l :: Double
</span><a href="#local-6989586621679164076"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Real a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164077"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                </span><span id="local-6989586621679164075"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679164075"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679164061"><span class="hs-identifier hs-var">floor'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164077"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164163"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164163"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679164156"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164156"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164201"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164201"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679164199"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164199"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span id="local-6989586621679164196"><span class="annot"><span class="annottext">newNode :: GraphState -&gt; WidgetNode s e
</span><a href="#local-6989586621679164196"><span class="hs-identifier hs-var hs-var">newNode</span></a></span></span><span> </span><span id="local-6989586621679164059"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164059"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164059"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164238"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679164227"><span class="annot"><span class="annottext">handleReleased :: WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164227"><span class="hs-identifier hs-var hs-var">handleReleased</span></a></span></span><span> </span><span id="local-6989586621679164058"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164058"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164057"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetRequest s e]
</span><a href="#local-6989586621679164056"><span class="hs-identifier hs-var">reqs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679164057"><span class="annot"><span class="annottext">newNode :: WidgetNode s e
</span><a href="#local-6989586621679164057"><span class="hs-identifier hs-var hs-var">newNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164058"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span id="local-6989586621679164054"><span class="annot"><span class="annottext">newState :: GraphState
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-216"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsMousePosition :: Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-217"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsActivePoint :: Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsActivePoint"><span class="hs-identifier hs-var">_gsActivePoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span>        </span><span id="local-6989586621679164056"><span class="annot"><span class="annottext">reqs :: [WidgetRequest s e]
</span><a href="#local-6989586621679164056"><span class="hs-identifier hs-var hs-var">reqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphState -&gt; Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsActivePoint"><span class="hs-identifier hs-var">_gsActivePoint</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164051"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s e. GraphData s e -&gt; [Int -&gt; WidgetRequest s e]
</span><a href="Monomer.Graph.GraphData.html#_gdClickReq"><span class="hs-identifier hs-var">_gdClickReq</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[GraphData s e]
</span><a href="#local-6989586621679164315"><span class="hs-identifier hs-var">graphDatas</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164048"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679164048"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164048"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164051"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164051"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsActivePoint"><span class="hs-identifier hs-var">_gsActivePoint</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679164224"><span class="annot"><span class="annottext">handleMove :: WidgetEnv s e
-&gt; WidgetNode s e -&gt; Point -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164224"><span class="hs-identifier hs-var hs-var">handleMove</span></a></span></span><span> </span><span id="local-6989586621679164044"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164044"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679164043"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679164042"><span class="annot"><span class="annottext">moveP :: Point
</span><a href="#local-6989586621679164042"><span class="hs-identifier hs-var">moveP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164041"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679164040"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164040"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164039"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>        </span><span id="local-6989586621679164039"><span class="annot"><span class="annottext">result :: Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164039"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164038"><span class="hs-identifier hs-var">newNode</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetRequest s e]
</span><a href="#local-6989586621679164037"><span class="hs-identifier hs-var">reqs</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span id="local-6989586621679164038"><span class="annot"><span class="annottext">newNode :: WidgetNode s e
</span><a href="#local-6989586621679164038"><span class="hs-identifier hs-var hs-var">newNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164035"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span id="local-6989586621679164035"><span class="annot"><span class="annottext">newState :: GraphState
</span><a href="#local-6989586621679164035"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetEnv s e -&gt; WidgetNode s e -&gt; Bool
</span><span class="hs-identifier hs-var">isNodePressed</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164044"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679164027"><span class="hs-identifier hs-var">dragPoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetEnv s e -&gt; WidgetNode s e -&gt; Bool
</span><span class="hs-identifier hs-var">isNodePressed</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679164044"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Maybe Point
</span><a href="#local-6989586621679164025"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-230"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164024"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164023"><span class="hs-identifier hs-var">mx0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164022"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164040"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164021"><span class="hs-identifier hs-var">my0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsMousePosition :: Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679164042"><span class="hs-identifier hs-var">moveP</span></a></span><span>
</span><span id="line-232"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-233"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-234"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsHoverPoint :: Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsHoverPoint"><span class="hs-identifier hs-var">_gsHoverPoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679164020"><span class="hs-identifier hs-var">hp</span></a></span><span>
</span><span id="line-235"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>        </span><span id="local-6989586621679164037"><span class="annot"><span class="annottext">reqs :: [WidgetRequest s e]
</span><a href="#local-6989586621679164037"><span class="hs-identifier hs-var hs-var">reqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679164027"><span class="hs-identifier hs-var">dragPoint</span></a></span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s e. WidgetRequest s e
</span><span class="hs-identifier hs-var">RenderOnce</span></span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679164015"><span class="annot"><span class="annottext">Int -&gt; (Double, Double) -&gt; WidgetRequest s e
</span><a href="#local-6989586621679164015"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Double, Double) -&gt; WidgetRequest s e
</span><a href="#local-6989586621679164015"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164014"><span class="hs-identifier hs-var">dj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164013"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164012"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s e. WidgetRequest s e
</span><span class="hs-identifier hs-var">RenderOnce</span></span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621679164027"><span class="annot"><span class="annottext">dragPoint :: Bool
</span><a href="#local-6989586621679164027"><span class="hs-identifier hs-var hs-var">dragPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679164007"><span class="hs-identifier hs-var">dp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164024"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164024"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679164022"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164022"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164005"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164005"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679164004"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164004"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679164023"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164023"><span class="hs-identifier hs-var">mx0</span></a></span></span><span> </span><span id="local-6989586621679164021"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164021"><span class="hs-identifier hs-var">my0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Point
</span><a href="#local-6989586621679164025"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span id="local-6989586621679164025"><span class="annot"><span class="annottext">mp :: Maybe Point
</span><a href="#local-6989586621679164025"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Maybe Point
</span><a href="Monomer.Graph.GraphState.html#_gsMousePosition"><span class="hs-identifier hs-var">_gsMousePosition</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679163999"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163999"><span class="hs-identifier hs-var">di</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164014"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164014"><span class="hs-identifier hs-var">dj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679164007"><span class="hs-identifier hs-var">dp</span></a></span><span>
</span><span id="line-245"></span><span>        </span><span id="local-6989586621679164007"><span class="annot"><span class="annottext">dp :: Maybe (Int, Int)
</span><a href="#local-6989586621679164007"><span class="hs-identifier hs-var hs-var">dp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Maybe (Int, Int)
</span><a href="Monomer.Graph.GraphState.html#_gsActivePoint"><span class="hs-identifier hs-var">_gsActivePoint</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621679164011"><span class="annot"><span class="annottext">report :: [Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e.
GraphData s e -&gt; [Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
</span><a href="Monomer.Graph.GraphData.html#_gdChangeReq"><span class="hs-identifier hs-var">_gdChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[GraphData s e]
</span><a href="#local-6989586621679164315"><span class="hs-identifier hs-var">graphDatas</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163999"><span class="hs-identifier hs-var">di</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span id="local-6989586621679164020"><span class="annot"><span class="annottext">hp :: Maybe (Int, Int)
</span><a href="#local-6989586621679164020"><span class="hs-identifier hs-var hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {s} {e}.
(Num a, Enum a) =&gt;
[(a, GraphData s e)] -&gt; Maybe (a, a)
</span><a href="#local-6989586621679163991"><span class="hs-identifier hs-var">hoverPointData</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[GraphData s e]
</span><a href="#local-6989586621679164315"><span class="hs-identifier hs-var">graphDatas</span></a></span><span>
</span><span id="line-248"></span><span>        </span><span id="local-6989586621679163991"><span class="annot"><span class="annottext">hoverPointData :: [(a, GraphData s e)] -&gt; Maybe (a, a)
</span><a href="#local-6989586621679163991"><span class="hs-identifier hs-var hs-var">hoverPointData</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><a href="#local-6989586621679163991"><span class="hs-identifier hs-var">hoverPointData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679163983"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163983"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163982"><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163982"><span class="hs-identifier hs-var">graphData</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679163981"><span class="annot"><span class="annottext">[(a, GraphData s e)]
</span><a href="#local-6989586621679163981"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall s e. GraphData s e -&gt; Maybe Bool
</span><a href="Monomer.Graph.GraphData.html#_gdSeparate"><span class="hs-identifier hs-var">_gdSeparate</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163982"><span class="hs-identifier hs-var">graphData</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, GraphData s e)] -&gt; Maybe (a, a)
</span><a href="#local-6989586621679163991"><span class="hs-identifier hs-var">hoverPointData</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, GraphData s e)]
</span><a href="#local-6989586621679163981"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-251"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679163978"><span class="hs-identifier hs-var">hp'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, GraphData s e)] -&gt; Maybe (a, a)
</span><a href="#local-6989586621679163991"><span class="hs-identifier hs-var">hoverPointData</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, GraphData s e)]
</span><a href="#local-6989586621679163981"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-252"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163983"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679163978"><span class="hs-identifier hs-var">hp'</span></a></span><span>
</span><span id="line-253"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>                </span><span id="local-6989586621679163978"><span class="annot"><span class="annottext">hp' :: Maybe a
</span><a href="#local-6989586621679163978"><span class="hs-identifier hs-var hs-var">hp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. (Double, Double) -&gt; [(a, (Double, Double))] -&gt; Maybe a
</span><a href="#local-6989586621679163975"><span class="hs-identifier hs-var">getHP</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163974"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e. GraphData s e -&gt; [(Double, Double)]
</span><a href="Monomer.Graph.GraphData.html#_gdPoints"><span class="hs-identifier hs-var">_gdPoints</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163982"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-255"></span><span>                </span><span id="local-6989586621679163974"><span class="annot"><span class="annottext">rs :: (Double, Double)
</span><a href="#local-6989586621679163974"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163972"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163971"><span class="hs-identifier hs-var">ry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>                </span><span id="local-6989586621679163972"><span class="annot"><span class="annottext">rx :: Double
</span><a href="#local-6989586621679163972"><span class="hs-identifier hs-var hs-var">rx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163967"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164005"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e. GraphData s e -&gt; Maybe Double
</span><a href="Monomer.Graph.GraphData.html#_gdRadius"><span class="hs-identifier hs-var">_gdRadius</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163982"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-257"></span><span>                </span><span id="local-6989586621679163971"><span class="annot"><span class="annottext">ry :: Double
</span><a href="#local-6989586621679163971"><span class="hs-identifier hs-var hs-var">ry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163967"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164004"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e. GraphData s e -&gt; Maybe Double
</span><a href="Monomer.Graph.GraphData.html#_gdRadius"><span class="hs-identifier hs-var">_gdRadius</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163982"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-258"></span><span>                </span><span id="local-6989586621679163967"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679163967"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e. GraphData s e -&gt; Maybe Double
</span><a href="Monomer.Graph.GraphData.html#_gdWidth"><span class="hs-identifier hs-var">_gdWidth</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163982"><span class="hs-identifier hs-var">graphData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>        </span><span id="local-6989586621679163975"><span class="annot"><span class="annottext">getHP :: (Double, Double) -&gt; [(a, (Double, Double))] -&gt; Maybe a
</span><a href="#local-6989586621679163975"><span class="hs-identifier hs-var hs-var">getHP</span></a></span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><a href="#local-6989586621679163975"><span class="hs-identifier hs-var">getHP</span></a></span><span> </span><span id="local-6989586621679163959"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163959"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679163958"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163958"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163957"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163957"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679163956"><span class="annot"><span class="annottext">[(a, (Double, Double))]
</span><a href="#local-6989586621679163956"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; (Double, Double) -&gt; Bool
</span><a href="#local-6989586621679163955"><span class="hs-identifier hs-var">checkHover</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163957"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163959"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-261"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163958"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; [(a, (Double, Double))] -&gt; Maybe a
</span><a href="#local-6989586621679163975"><span class="hs-identifier hs-var">getHP</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163959"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, (Double, Double))]
</span><a href="#local-6989586621679163956"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span id="local-6989586621679163955"><span class="annot"><span class="annottext">checkHover :: (Double, Double) -&gt; (Double, Double) -&gt; Bool
</span><a href="#local-6989586621679163955"><span class="hs-identifier hs-var hs-var">checkHover</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163954"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163954"><span class="hs-identifier hs-var">px</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163953"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163953"><span class="hs-identifier hs-var">py</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163952"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163952"><span class="hs-identifier hs-var">rx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163951"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163951"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Rect -&gt; Bool
</span><span class="hs-identifier hs-var">pointInEllipse</span></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163949"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679163948"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>            </span><span id="local-6989586621679163949"><span class="annot"><span class="annottext">p :: Point
</span><a href="#local-6989586621679163949"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164013"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164012"><span class="hs-identifier hs-var">dy</span></a></span><span>
</span><span id="line-265"></span><span>            </span><span id="local-6989586621679163948"><span class="annot"><span class="annottext">rect :: Rect
</span><a href="#local-6989586621679163948"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Rect
</span><span class="hs-identifier hs-var">Rect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163954"><span class="hs-identifier hs-var">px</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163952"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163953"><span class="hs-identifier hs-var">py</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163951"><span class="hs-identifier hs-var">ry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163952"><span class="hs-identifier hs-var">rx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163951"><span class="hs-identifier hs-var">ry</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679164013"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164013"><span class="hs-identifier hs-var">dx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164012"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164012"><span class="hs-identifier hs-var">dy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163933"><span class="hs-identifier hs-var">ox</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164005"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163932"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164040"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164004"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679163933"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163933"><span class="hs-identifier hs-var">ox</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163932"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163932"><span class="hs-identifier hs-var">oy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163923"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163922"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164024"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163921"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163920"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679164022"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Rect</span></span><span> </span><span id="local-6989586621679163923"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163923"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679163921"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163921"><span class="hs-identifier hs-var">gy</span></a></span></span><span> </span><span id="local-6989586621679163922"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163922"><span class="hs-identifier hs-var">gw</span></a></span></span><span> </span><span id="local-6989586621679163920"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163920"><span class="hs-identifier hs-var">gh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679164197"><span class="annot"><span class="annottext">resultRender :: WidgetNode s e -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164197"><span class="hs-identifier hs-var hs-var">resultRender</span></a></span></span><span> </span><span id="local-6989586621679163919"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163919"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163919"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s e. WidgetRequest s e
</span><span class="hs-identifier hs-var">RenderOnce</span></span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679164281"><span class="annot"><span class="annottext">handleMessage :: p -&gt; WidgetNode s e -&gt; p -&gt; a -&gt; Maybe (WidgetResult s e)
</span><a href="#local-6989586621679164281"><span class="hs-identifier hs-var hs-var">handleMessage</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679163910"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163910"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679163909"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163909"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679163908"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679163908"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GraphMsg -&gt; GraphState
</span><a href="#local-6989586621679163907"><span class="hs-identifier hs-var">getNewState</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163909"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s e.
WidgetNode s e -&gt; [WidgetRequest s e] -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultReqs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679163908"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163910"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s e. WidgetRequest s e
</span><span class="hs-identifier hs-var">RenderOnce</span></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679163907"><span class="annot"><span class="annottext">getNewState :: GraphMsg -&gt; GraphState
</span><a href="#local-6989586621679163907"><span class="hs-identifier hs-var hs-var">getNewState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.Graph.GraphMsg.html#GraphSetTranslation"><span class="hs-identifier hs-type">GraphSetTranslation</span></a></span><span> </span><span id="local-6989586621679163903"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163903"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163903"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><a href="#local-6989586621679163907"><span class="hs-identifier hs-var">getNewState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Monomer.Graph.GraphMsg.html#GraphSetScale"><span class="hs-identifier hs-type">GraphSetScale</span></a></span><span> </span><span id="local-6989586621679163901"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163901"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsScale :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163901"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="#local-6989586621679163907"><span class="hs-identifier hs-var">getNewState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphMsg
</span><a href="Monomer.Graph.GraphMsg.html#GraphReset"><span class="hs-identifier hs-var">GraphReset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsViewport :: Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679164277"><span class="annot"><span class="annottext">getSizeReq :: p -&gt; p -&gt; (SizeReq, SizeReq)
</span><a href="#local-6989586621679164277"><span class="hs-identifier hs-var hs-var">getSizeReq</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; SizeReq
</span><span class="hs-identifier hs-var">rangeSize</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2000</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; SizeReq
</span><span class="hs-identifier hs-var">rangeSize</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2000</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679164275"><span class="annot"><span class="annottext">resize :: p -&gt; WidgetNode s e -&gt; Rect -&gt; WidgetResult s e
</span><a href="#local-6989586621679164275"><span class="hs-identifier hs-var hs-var">resize</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679163898"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163898"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679163897"><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679163897"><span class="hs-identifier hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s e. WidgetNode s e -&gt; WidgetResult s e
</span><span class="hs-identifier hs-var">resultNode</span></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163896"><span class="hs-identifier hs-var">resNode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>        </span><span id="local-6989586621679163896"><span class="annot"><span class="annottext">resNode :: WidgetNode s e
</span><a href="#local-6989586621679163896"><span class="hs-identifier hs-var hs-var">resNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}. HasWidget t (Widget s e) =&gt; GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var">makeNodeWithState</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679163894"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163898"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679163894"><span class="annot"><span class="annottext">newState :: GraphState
</span><a href="#local-6989586621679163894"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gsViewport :: Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679163897"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679164273"><span class="annot"><span class="annottext">render :: WidgetEnv s e -&gt; WidgetNode s e -&gt; Renderer -&gt; IO ()
</span><a href="#local-6989586621679164273"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679163786"><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">wenv</span></a></span></span><span> </span><span id="local-6989586621679163785"><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679163784"><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163783"><span class="annot"><span class="annottext">style :: StyleState
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {e}. WidgetEnv s e -&gt; WidgetNode s e -&gt; StyleState
</span><span class="hs-identifier hs-var">currentStyle</span></span><span> </span><span class="annot"><span class="annottext">WidgetEnv s e
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">wenv</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetNode s e
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-288"></span><span>            </span><span id="local-6989586621679163782"><span class="annot"><span class="annottext">rect :: Rect
</span><a href="#local-6989586621679163782"><span class="hs-identifier hs-var">rect</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rect</span></span><span> </span><span id="local-6989586621679163781"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679163780"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span></span><span> </span><span id="local-6989586621679163779"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span></span><span> </span><span id="local-6989586621679163778"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163777"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163777"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679163776"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163776"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163775"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679163774"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163773"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163773"><span class="hs-identifier hs-var">ux</span></a></span></span><span> </span><span id="local-6989586621679163772"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163772"><span class="hs-identifier hs-var">uy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsUnit"><span class="hs-identifier hs-var">_gsUnit</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163771"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679163770"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsSections"><span class="hs-identifier hs-var">_gsSections</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-293"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163761"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163760"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163777"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163776"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163758"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163758"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163757"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163757"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163755"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163755"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163754"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163754"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>            </span><span id="local-6989586621679163753"><span class="annot"><span class="annottext">line :: Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679163752"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163752"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679163751"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679163750"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163750"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679163749"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163749"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; Point -&gt; Double -&gt; Maybe Color -&gt; IO ()
</span><span class="hs-identifier hs-var">drawLine</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163752"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163750"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163749"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-297"></span><span>            </span><span id="local-6989586621679163747"><span class="annot"><span class="annottext">font :: Font
</span><a href="#local-6989586621679163747"><span class="hs-identifier hs-var hs-var">font</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StyleState -&gt; Font
</span><span class="hs-identifier hs-var">styleFont</span></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-298"></span><span>            </span><span id="local-6989586621679163745"><span class="annot"><span class="annottext">fsize :: FontSize
</span><a href="#local-6989586621679163745"><span class="hs-identifier hs-var hs-var">fsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FontSize
</span><span class="hs-identifier hs-var">FontSize</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span>
</span><span id="line-299"></span><span>            </span><span id="local-6989586621679163741"><span class="annot"><span class="annottext">printText :: Point -&gt; Text -&gt; IO ()
</span><a href="#local-6989586621679163741"><span class="hs-identifier hs-var hs-var">printText</span></a></span></span><span> </span><span id="local-6989586621679163740"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163740"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679163739"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679163739"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; Font -&gt; FontSize -&gt; FontSpace -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">renderText</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163740"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Font
</span><a href="#local-6989586621679163747"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">FontSize
</span><a href="#local-6989586621679163745"><span class="hs-identifier hs-var">fsize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679163739"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span id="local-6989586621679163737"><span class="annot"><span class="annottext">show' :: Double -&gt; String
</span><a href="#local-6989586621679163737"><span class="hs-identifier hs-var hs-var">show'</span></a></span></span><span> </span><span id="local-6989586621679163736"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163735"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>                </span><span id="local-6989586621679163735"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679163735"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-302"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; Maybe Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showFFloat</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163722"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-304"></span><span>                </span><span id="local-6989586621679163722"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679163722"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163719"><span class="hs-identifier hs-var">bn</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163719"><span class="hs-identifier hs-var">bn</span></a></span><span>
</span><span id="line-305"></span><span>                </span><span id="local-6989586621679163719"><span class="annot"><span class="annottext">bn :: Double
</span><a href="#local-6989586621679163719"><span class="hs-identifier hs-var hs-var">bn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1000000000</span></span><span>
</span><span id="line-306"></span><span>            </span><span id="local-6989586621679163717"><span class="annot"><span class="annottext">printN :: Point -&gt; Double -&gt; IO ()
</span><a href="#local-6989586621679163717"><span class="hs-identifier hs-var hs-var">printN</span></a></span></span><span> </span><span id="local-6989586621679163716"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163716"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Text -&gt; IO ()
</span><a href="#local-6989586621679163741"><span class="hs-identifier hs-var">printText</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163716"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
</span><a href="#local-6989586621679163737"><span class="hs-identifier hs-var">show'</span></a></span><span>
</span><span id="line-307"></span><span>            </span><span id="local-6989586621679163709"><span class="annot"><span class="annottext">background :: Maybe Color
</span><a href="#local-6989586621679163709"><span class="hs-identifier hs-var hs-var">background</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s a. HasBgColor s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.bgColor</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">white</span></span><span>
</span><span id="line-308"></span><span>            </span><span id="local-6989586621679163702"><span class="annot"><span class="annottext">fore :: Color
</span><a href="#local-6989586621679163702"><span class="hs-identifier hs-var hs-var">fore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s a. HasFgColor s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.fgColor</span></span><span>
</span><span id="line-309"></span><span>            </span><span id="local-6989586621679163696"><span class="annot"><span class="annottext">foreN :: Color
</span><a href="#local-6989586621679163696"><span class="hs-identifier hs-var hs-var">foreN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StyleState
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s a. HasSndColor s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.sndColor</span></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; Rect -&gt; Maybe Color -&gt; Maybe Radius -&gt; IO ()
</span><span class="hs-identifier hs-var">drawRect</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679163782"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163709"><span class="hs-identifier hs-var">background</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var">saveContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; Rect -&gt; IO ()
</span><span class="hs-identifier hs-var">intersectScissor</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679163782"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164300"><span class="hs-identifier hs-var">_gcHideGrid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163758"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163757"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163702"><span class="hs-identifier hs-var">fore</span></a></span><span>
</span><span id="line-315"></span><span>            </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163755"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163754"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163702"><span class="hs-identifier hs-var">fore</span></a></span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163684"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163683"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163773"><span class="hs-identifier hs-var">ux</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163772"><span class="hs-identifier hs-var">uy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>            </span><span id="local-6989586621679163681"><span class="annot"><span class="annottext">verLine :: Double -&gt; IO ()
</span><a href="#local-6989586621679163681"><span class="hs-identifier hs-var hs-var">verLine</span></a></span></span><span> </span><span id="local-6989586621679163680"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163680"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163680"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163680"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163702"><span class="hs-identifier hs-var">fore</span></a></span><span>
</span><span id="line-318"></span><span>            </span><span id="local-6989586621679163678"><span class="annot"><span class="annottext">horLine :: Double -&gt; IO ()
</span><a href="#local-6989586621679163678"><span class="hs-identifier hs-var hs-var">horLine</span></a></span></span><span> </span><span id="local-6989586621679163677"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163677"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Point -&gt; Double -&gt; Color -&gt; IO ()
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163677"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163677"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163702"><span class="hs-identifier hs-var">fore</span></a></span><span>
</span><span id="line-319"></span><span>            </span><span id="local-6989586621679163671"><span class="annot"><span class="annottext">uxl :: Double -&gt; b
</span><a href="#local-6989586621679163671"><span class="hs-identifier hs-var hs-var">uxl</span></a></span></span><span> </span><span id="local-6989586621679163670"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163670"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
</span><a href="#local-6989586621679163737"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163772"><span class="hs-identifier hs-var">uy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163670"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-320"></span><span>            </span><span id="local-6989586621679163655"><span class="annot"><span class="annottext">clampX :: Double -&gt; Double
</span><a href="#local-6989586621679163655"><span class="hs-identifier hs-var hs-var">clampX</span></a></span></span><span> </span><span id="local-6989586621679163654"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163654"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {b}. Num b =&gt; Double -&gt; b
</span><a href="#local-6989586621679163671"><span class="hs-identifier hs-var">uxl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163654"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span>
</span><span id="line-321"></span><span>            </span><span id="local-6989586621679163642"><span class="annot"><span class="annottext">clampY :: Double
</span><a href="#local-6989586621679163642"><span class="hs-identifier hs-var hs-var">clampY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span>
</span><span id="line-322"></span><span>            </span><span id="local-6989586621679163636"><span class="annot"><span class="annottext">verN :: Double -&gt; IO ()
</span><a href="#local-6989586621679163636"><span class="hs-identifier hs-var hs-var">verN</span></a></span></span><span> </span><span id="local-6989586621679163635"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163635"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; IO ()
</span><a href="#local-6989586621679163717"><span class="hs-identifier hs-var">printN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163635"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163642"><span class="hs-identifier hs-var">clampY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163773"><span class="hs-identifier hs-var">ux</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163635"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-323"></span><span>            </span><span id="local-6989586621679163631"><span class="annot"><span class="annottext">horN :: Double -&gt; IO ()
</span><a href="#local-6989586621679163631"><span class="hs-identifier hs-var hs-var">horN</span></a></span></span><span> </span><span id="local-6989586621679163630"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163630"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Double -&gt; IO ()
</span><a href="#local-6989586621679163717"><span class="hs-identifier hs-var">printN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163655"><span class="hs-identifier hs-var">clampX</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163630"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163630"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163772"><span class="hs-identifier hs-var">uy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163630"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span id="local-6989586621679163626"><span class="annot"><span class="annottext">horN' :: Double -&gt; IO ()
</span><a href="#local-6989586621679163626"><span class="hs-identifier hs-var hs-var">horN'</span></a></span></span><span> </span><span id="local-6989586621679163625"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163625"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163625"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163631"><span class="hs-identifier hs-var">horN</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163625"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163621"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163620"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163777"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163776"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>            </span><span id="local-6989586621679163614"><span class="annot"><span class="annottext">ovx :: Double
</span><a href="#local-6989586621679163614"><span class="hs-identifier hs-var hs-var">ovx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163777"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">vs</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-327"></span><span>            </span><span id="local-6989586621679163608"><span class="annot"><span class="annottext">ovy :: Double
</span><a href="#local-6989586621679163608"><span class="hs-identifier hs-var hs-var">ovy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">round'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163776"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var">hs</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-328"></span><span>            </span><span id="local-6989586621679163605"><span class="annot"><span class="annottext">ovx1 :: Double
</span><a href="#local-6989586621679163605"><span class="hs-identifier hs-var hs-var">ovx1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span id="local-6989586621679163602"><span class="annot"><span class="annottext">ovy1 :: Double
</span><a href="#local-6989586621679163602"><span class="hs-identifier hs-var hs-var">ovy1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164302"><span class="hs-identifier hs-var">_gcHideMinor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164300"><span class="hs-identifier hs-var">_gcHideGrid</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-331"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">drawInAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163614"><span class="hs-identifier hs-var">ovx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163614"><span class="hs-identifier hs-var">ovx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163681"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-333"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163614"><span class="hs-identifier hs-var">ovx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163614"><span class="hs-identifier hs-var">ovx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163681"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-334"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163608"><span class="hs-identifier hs-var">ovy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163608"><span class="hs-identifier hs-var">ovy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163678"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-335"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163608"><span class="hs-identifier hs-var">ovy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163608"><span class="hs-identifier hs-var">ovy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163678"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164300"><span class="hs-identifier hs-var">_gcHideGrid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">drawInAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163605"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163605"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163681"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-339"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163605"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163605"><span class="hs-identifier hs-var">ovx1</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163684"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">gx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163779"><span class="hs-identifier hs-var">gw</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163681"><span class="hs-identifier hs-var">verLine</span></a></span><span>
</span><span id="line-340"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163602"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163602"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163678"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-341"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163602"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163602"><span class="hs-identifier hs-var">ovy1</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163683"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163780"><span class="hs-identifier hs-var">gy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">gh</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163678"><span class="hs-identifier hs-var">horLine</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163588"><span class="annot"><span class="annottext">p :: (Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679163588"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163587"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163587"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163586"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163586"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163587"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">ox</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163586"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">oy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[GraphData s e]
</span><a href="#local-6989586621679164315"><span class="hs-identifier hs-var">graphDatas</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679163585"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163585"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163584"><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163584"><span class="hs-identifier hs-var">graphData</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163572"><span id="local-6989586621679163573"><span id="local-6989586621679163574"><span id="local-6989586621679163575"><span id="local-6989586621679163576"><span id="local-6989586621679163577"><span id="local-6989586621679163578"><span id="local-6989586621679163579"><span id="local-6989586621679163580"><span id="local-6989586621679163581"><span id="local-6989586621679163582"><span class="annot"><span class="annottext">[(Double, Double)]
[Int -&gt; WidgetRequest s e]
[Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
Maybe Bool
Maybe Double
Maybe Color
_gdFillAlpha :: forall s e. GraphData s e -&gt; Maybe Double
_gdFill :: forall s e. GraphData s e -&gt; Maybe Bool
_gdActiveColor :: forall s e. GraphData s e -&gt; Maybe Color
_gdHoverColor :: forall s e. GraphData s e -&gt; Maybe Color
_gdColor :: forall s e. GraphData s e -&gt; Maybe Color
_gdClickReq :: [Int -&gt; WidgetRequest s e]
_gdChangeReq :: [Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
_gdFillAlpha :: Maybe Double
_gdFill :: Maybe Bool
_gdSeparate :: Maybe Bool
_gdRadius :: Maybe Double
_gdWidth :: Maybe Double
_gdActiveColor :: Maybe Color
_gdHoverColor :: Maybe Color
_gdColor :: Maybe Color
_gdPoints :: [(Double, Double)]
_gdWidth :: forall s e. GraphData s e -&gt; Maybe Double
_gdRadius :: forall s e. GraphData s e -&gt; Maybe Double
_gdPoints :: forall s e. GraphData s e -&gt; [(Double, Double)]
_gdSeparate :: forall s e. GraphData s e -&gt; Maybe Bool
_gdChangeReq :: forall s e.
GraphData s e -&gt; [Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
_gdClickReq :: forall s e. GraphData s e -&gt; [Int -&gt; WidgetRequest s e]
</span><a href="Monomer.Graph.GraphData.html#_gdFillAlpha"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163584"><span class="hs-identifier hs-var">graphData</span></a></span><span>
</span><span id="line-345"></span><span>                </span><span id="local-6989586621679163565"><span class="annot"><span class="annottext">ps :: [(Double, Double)]
</span><a href="#local-6989586621679163565"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679163588"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163582"><span class="hs-identifier hs-var">_gdPoints</span></a></span><span>
</span><span id="line-346"></span><span>                </span><span id="local-6989586621679163564"><span class="annot"><span class="annottext">newGraphData :: GraphData s e
</span><a href="#local-6989586621679163564"><span class="hs-identifier hs-var hs-var">newGraphData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163584"><span class="hs-identifier hs-var">graphData</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_gdPoints :: [(Double, Double)]
</span><a href="Monomer.Graph.GraphData.html#_gdPoints"><span class="hs-identifier hs-var">_gdPoints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163565"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-347"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163581"><span class="hs-identifier hs-var">_gdColor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-348"></span><span>                </span><span class="annot"><span class="annottext">forall {s} {e}. Renderer -&gt; GraphData s e -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679163563"><span class="hs-identifier hs-var">renderGraphData</span></a></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">GraphData s e
</span><a href="#local-6989586621679163564"><span class="hs-identifier hs-var">newGraphData</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163585"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164301"><span class="hs-identifier hs-var">_gcHideNumbers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679164300"><span class="hs-identifier hs-var">_gcHideGrid</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Color -&gt; IO ()
</span><span class="hs-identifier hs-var">setFillColor</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679163696"><span class="hs-identifier hs-var">foreN</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">drawInAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.62</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163636"><span class="hs-identifier hs-var">verN</span></a></span><span>
</span><span id="line-353"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163621"><span class="hs-identifier hs-var">fox</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163636"><span class="hs-identifier hs-var">verN</span></a></span><span>
</span><span id="line-354"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163626"><span class="hs-identifier hs-var">horN'</span></a></span><span>
</span><span id="line-355"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163620"><span class="hs-identifier hs-var">foy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; IO ()
</span><a href="#local-6989586621679163626"><span class="hs-identifier hs-var">horN'</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var">restoreContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163784"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679163563"><span class="annot"><span class="annottext">renderGraphData :: Renderer -&gt; GraphData s e -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679163563"><span class="hs-identifier hs-var hs-var">renderGraphData</span></a></span></span><span> </span><span id="local-6989586621679163526"><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span></span><span> </span><span class="annot"><a href="Monomer.Graph.GraphData.html#GraphData"><span class="hs-identifier hs-type">GraphData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163515"><span id="local-6989586621679163516"><span id="local-6989586621679163517"><span id="local-6989586621679163518"><span id="local-6989586621679163519"><span id="local-6989586621679163520"><span id="local-6989586621679163521"><span id="local-6989586621679163522"><span id="local-6989586621679163523"><span id="local-6989586621679163524"><span id="local-6989586621679163525"><span class="annot"><span class="annottext">[(Double, Double)]
[Int -&gt; WidgetRequest s e]
[Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
Maybe Bool
Maybe Double
Maybe Color
_gdClickReq :: [Int -&gt; WidgetRequest s e]
_gdChangeReq :: [Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
_gdFillAlpha :: Maybe Double
_gdFill :: Maybe Bool
_gdSeparate :: Maybe Bool
_gdRadius :: Maybe Double
_gdWidth :: Maybe Double
_gdActiveColor :: Maybe Color
_gdHoverColor :: Maybe Color
_gdColor :: Maybe Color
_gdPoints :: [(Double, Double)]
_gdFillAlpha :: forall s e. GraphData s e -&gt; Maybe Double
_gdFill :: forall s e. GraphData s e -&gt; Maybe Bool
_gdActiveColor :: forall s e. GraphData s e -&gt; Maybe Color
_gdHoverColor :: forall s e. GraphData s e -&gt; Maybe Color
_gdColor :: forall s e. GraphData s e -&gt; Maybe Color
_gdWidth :: forall s e. GraphData s e -&gt; Maybe Double
_gdRadius :: forall s e. GraphData s e -&gt; Maybe Double
_gdPoints :: forall s e. GraphData s e -&gt; [(Double, Double)]
_gdSeparate :: forall s e. GraphData s e -&gt; Maybe Bool
_gdChangeReq :: forall s e.
GraphData s e -&gt; [Int -&gt; (Double, Double) -&gt; WidgetRequest s e]
_gdClickReq :: forall s e. GraphData s e -&gt; [Int -&gt; WidgetRequest s e]
</span><a href="#local-6989586621679163515"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679163514"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163514"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Monomer.Graph.GraphState.html#GraphState"><span class="hs-identifier hs-type">GraphState</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163505"><span id="local-6989586621679163506"><span id="local-6989586621679163507"><span id="local-6989586621679163508"><span id="local-6989586621679163509"><span id="local-6989586621679163510"><span id="local-6989586621679163511"><span id="local-6989586621679163512"><span class="annot"><span class="annottext">Maybe (Int, Int)
Maybe Point
Rect
Point
_gsViewport :: Rect
_gsActivePoint :: Maybe (Int, Int)
_gsHoverPoint :: Maybe (Int, Int)
_gsMousePosition :: Maybe Point
_gsSections :: Point
_gsUnit :: Point
_gsScale :: Point
_gsTranslation :: Point
_gsSections :: GraphState -&gt; Point
_gsUnit :: GraphState -&gt; Point
_gsScale :: GraphState -&gt; Point
_gsTranslation :: GraphState -&gt; Point
_gsActivePoint :: GraphState -&gt; Maybe (Int, Int)
_gsMousePosition :: GraphState -&gt; Maybe Point
_gsViewport :: GraphState -&gt; Rect
_gsHoverPoint :: GraphState -&gt; Maybe (Int, Int)
</span><a href="#local-6989586621679163505"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163504"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163504"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679163503"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163503"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679163511"><span class="hs-identifier hs-var">_gsScale</span></a></span><span>
</span><span id="line-361"></span><span>            </span><span id="local-6989586621679163502"><span class="annot"><span class="annottext">ps :: [(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163525"><span class="hs-identifier hs-var">_gdPoints</span></a></span><span>
</span><span id="line-362"></span><span>            </span><span id="local-6989586621679163501"><span class="annot"><span class="annottext">c :: Maybe Color
</span><a href="#local-6989586621679163501"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163524"><span class="hs-identifier hs-var">_gdColor</span></a></span><span>
</span><span id="line-363"></span><span>            </span><span id="local-6989586621679163499"><span class="annot"><span class="annottext">w :: Double
</span><a href="#local-6989586621679163499"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679163521"><span class="hs-identifier hs-var">_gdWidth</span></a></span><span>
</span><span id="line-364"></span><span>            </span><span id="local-6989586621679163492"><span class="annot"><span class="annottext">rx :: Double
</span><a href="#local-6989586621679163492"><span class="hs-identifier hs-var hs-var">rx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163499"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163504"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679163520"><span class="hs-identifier hs-var">_gdRadius</span></a></span><span>
</span><span id="line-365"></span><span>            </span><span id="local-6989586621679163485"><span class="annot"><span class="annottext">ry :: Double
</span><a href="#local-6989586621679163485"><span class="hs-identifier hs-var hs-var">ry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163499"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163503"><span class="hs-identifier hs-var">cy</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679163520"><span class="hs-identifier hs-var">_gdRadius</span></a></span><span>
</span><span id="line-366"></span><span>            </span><span id="local-6989586621679163483"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679163483"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.32</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679163517"><span class="hs-identifier hs-var">_gdFillAlpha</span></a></span><span>
</span><span id="line-367"></span><span>            </span><span id="local-6989586621679163482"><span class="annot"><span class="annottext">p :: (Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163481"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163481"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163480"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163480"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163481"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163480"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span id="local-6989586621679163479"><span class="annot"><span class="annottext">connect :: ((Double, Double), (Double, Double)) -&gt; IO ()
</span><a href="#local-6989586621679163479"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163478"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163478"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163477"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163477"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; Point -&gt; Double -&gt; Maybe Color -&gt; IO ()
</span><span class="hs-identifier hs-var">drawLine</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163478"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163477"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163499"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163501"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-369"></span><span>            </span><span id="local-6989586621679163476"><span class="annot"><span class="annottext">drawDot :: Maybe Color -&gt; Point -&gt; IO ()
</span><a href="#local-6989586621679163476"><span class="hs-identifier hs-var hs-var">drawDot</span></a></span></span><span> </span><span id="local-6989586621679163475"><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163475"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163474"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163474"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679163473"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163473"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Rect -&gt; Maybe Color -&gt; IO ()
</span><span class="hs-identifier hs-var">drawEllipse</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Rect
</span><a href="#local-6989586621679163471"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163475"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>                </span><span id="local-6989586621679163471"><span class="annot"><span class="annottext">r :: Rect
</span><a href="#local-6989586621679163471"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Rect
</span><span class="hs-identifier hs-var">Rect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163474"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163492"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163473"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163485"><span class="hs-identifier hs-var">ry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163492"><span class="hs-identifier hs-var">rx</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163485"><span class="hs-identifier hs-var">ry</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>            </span><span id="local-6989586621679163458"><span class="annot"><span class="annottext">getSeparateColor :: Int -&gt; Maybe Color
</span><a href="#local-6989586621679163458"><span class="hs-identifier hs-var hs-var">getSeparateColor</span></a></span></span><span> </span><span id="local-6989586621679163457"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163457"><span class="hs-identifier hs-var">j</span></a></span></span><span>
</span><span id="line-372"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679163506"><span class="hs-identifier hs-var">_gsActivePoint</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163514"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163457"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163522"><span class="hs-identifier hs-var">_gdActiveColor</span></a></span><span>
</span><span id="line-373"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679163507"><span class="hs-identifier hs-var">_gsHoverPoint</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163514"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163457"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163523"><span class="hs-identifier hs-var">_gdHoverColor</span></a></span><span>
</span><span id="line-374"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-375"></span><span>            </span><span id="local-6989586621679163455"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679163455"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679163519"><span class="hs-identifier hs-var">_gdSeparate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-377"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679163454"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163454"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163453"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163453"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-378"></span><span>                </span><span class="annot"><span class="annottext">Maybe Color -&gt; Point -&gt; IO ()
</span><a href="#local-6989586621679163476"><span class="hs-identifier hs-var">drawDot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Color
</span><a href="#local-6989586621679163458"><span class="hs-identifier hs-var">getSeparateColor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163454"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163501"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679163453"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-379"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163455"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Double, Double), (Double, Double)) -&gt; IO ()
</span><a href="#local-6989586621679163479"><span class="hs-identifier hs-var">connect</span></a></span><span>
</span><span id="line-381"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163455"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color -&gt; Point -&gt; IO ()
</span><a href="#local-6989586621679163476"><span class="hs-identifier hs-var">drawDot</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163501"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679163518"><span class="hs-identifier hs-var">_gdFill</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163455"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var">beginPath</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; IO ()
</span><span class="hs-identifier hs-var">moveTo</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679163502"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Renderer -&gt; Point -&gt; IO ()
</span><span class="hs-identifier hs-var">renderLineTo</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Point
</span><a href="#local-6989586621679163482"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-386"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var">saveContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Double -&gt; IO ()
</span><span class="hs-identifier hs-var">setGlobalAlpha</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163483"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; Color -&gt; IO ()
</span><span class="hs-identifier hs-var">setFillColor</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679163501"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var">fill</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="annottext">Renderer -&gt; IO ()
</span><span class="hs-identifier hs-var">restoreContext</span></span><span> </span><span class="annot"><span class="annottext">Renderer
</span><a href="#local-6989586621679163526"><span class="hs-identifier hs-var">renderer</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="#local-6989586621679164061"><span class="hs-identifier hs-type">floor'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621679164061"><span class="annot"><span class="annottext">floor' :: Double -&gt; Double
</span><a href="#local-6989586621679164061"><span class="hs-identifier hs-var hs-var">floor'</span></a></span></span><span> </span><span id="local-6989586621679163444"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163444"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163444"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="#local-6989586621679163726"><span class="hs-identifier hs-type">round'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-396"></span><span>    </span><span id="local-6989586621679163726"><span class="annot"><span class="annottext">round' :: Double -&gt; Double
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var hs-var">round'</span></a></span></span><span> </span><span id="local-6989586621679163442"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163442"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163442"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621679164249"><span class="annot"><span class="annottext">makeNodeWithState :: GraphState -&gt; t -&gt; t
</span><a href="#local-6989586621679164249"><span class="hs-identifier hs-var hs-var">makeNodeWithState</span></a></span></span><span> </span><span id="local-6989586621679163438"><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679163438"><span class="hs-identifier hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s a. HasWidget s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">L.widget</span></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Widget s e
</span><a href="#local-6989586621679163436"><span class="hs-identifier hs-var">newWidget</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>        </span><span id="local-6989586621679163436"><span class="annot"><span class="annottext">newWidget :: Widget s e
</span><a href="#local-6989586621679163436"><span class="hs-identifier hs-var hs-var">newWidget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e s.
WidgetEvent e =&gt;
[GraphData s e] -&gt; GraphCfg s e -&gt; GraphState -&gt; Widget s e
</span><a href="Monomer.Graph.html#makeGraph"><span class="hs-identifier hs-var">makeGraph</span></a></span><span> </span><span class="annot"><span class="annottext">[GraphData s e]
</span><a href="#local-6989586621679164315"><span class="hs-identifier hs-var">graphDatas</span></a></span><span> </span><span class="annot"><span class="annottext">GraphCfg s e
</span><a href="#local-6989586621679164314"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679163438"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679164291"><span class="annot"><span class="annottext">state :: GraphState
</span><a href="#local-6989586621679164291"><span class="hs-identifier hs-var hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679163434"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>        </span><span id="local-6989586621679163434"><span class="annot"><span class="annottext">newState :: GraphState
</span><a href="#local-6989586621679163434"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164297"><span class="hs-identifier hs-var">orState</span></a></span><span>
</span><span id="line-403"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_gsTranslation :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163433"><span class="hs-identifier hs-var">tx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163432"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-404"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_gsScale :: Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163431"><span class="hs-identifier hs-var">cx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163430"><span class="hs-identifier hs-var">cy'</span></a></span><span>
</span><span id="line-405"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-406"></span><span>        </span><span id="local-6989586621679163433"><span class="annot"><span class="annottext">tx' :: Double
</span><a href="#local-6989586621679163433"><span class="hs-identifier hs-var hs-var">tx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163414"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163413"><span class="hs-identifier hs-var">maxX</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163431"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163414"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163412"><span class="hs-identifier hs-var">minX</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163431"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163411"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-407"></span><span>        </span><span id="local-6989586621679163432"><span class="annot"><span class="annottext">ty' :: Double
</span><a href="#local-6989586621679163432"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163396"><span class="hs-identifier hs-var">minY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163430"><span class="hs-identifier hs-var">cy'</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163395"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163394"><span class="hs-identifier hs-var">maxY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163430"><span class="hs-identifier hs-var">cy'</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163395"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163393"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-408"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679163431"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163431"><span class="hs-identifier hs-var">cx'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163430"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163430"><span class="hs-identifier hs-var">cy'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; (Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679164142"><span class="hs-identifier hs-var">clampScale</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163414"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163395"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163392"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163391"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163411"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163411"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679163393"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163393"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsTranslation"><span class="hs-identifier hs-var">_gsTranslation</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164297"><span class="hs-identifier hs-var">orState</span></a></span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span id="local-6989586621679163392"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163392"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679163391"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163391"><span class="hs-identifier hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Point
</span><a href="Monomer.Graph.GraphState.html#_gsScale"><span class="hs-identifier hs-var">_gsScale</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164297"><span class="hs-identifier hs-var">orState</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Rect</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679163414"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163414"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679163395"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163395"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphState -&gt; Rect
</span><a href="Monomer.Graph.GraphState.html#_gsViewport"><span class="hs-identifier hs-var">_gsViewport</span></a></span><span> </span><span class="annot"><span class="annottext">GraphState
</span><a href="#local-6989586621679164297"><span class="hs-identifier hs-var">orState</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679164142"><span class="annot"><span class="annottext">clampScale :: Double -&gt; Double -&gt; (Double, Double) -&gt; (Double, Double)
</span><a href="#local-6989586621679164142"><span class="hs-identifier hs-var hs-var">clampScale</span></a></span></span><span> </span><span id="local-6989586621679163390"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163390"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679163389"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163389"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163388"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163388"><span class="hs-identifier hs-var">cx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163387"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163387"><span class="hs-identifier hs-var">cy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163386"><span class="hs-identifier hs-var">cx'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163385"><span class="hs-identifier hs-var">cy'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-414"></span><span>        </span><span id="local-6989586621679163386"><span class="annot"><span class="annottext">cx' :: Double
</span><a href="#local-6989586621679163386"><span class="hs-identifier hs-var hs-var">cx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163382"><span class="hs-identifier hs-var">minCx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163381"><span class="hs-identifier hs-var">maxCx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163388"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span id="local-6989586621679163385"><span class="annot"><span class="annottext">cy' :: Double
</span><a href="#local-6989586621679163385"><span class="hs-identifier hs-var hs-var">cy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163378"><span class="hs-identifier hs-var">minCy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163377"><span class="hs-identifier hs-var">maxCy</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163387"><span class="hs-identifier hs-var">cy</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span id="local-6989586621679163382"><span class="annot"><span class="annottext">minCx :: Double
</span><a href="#local-6989586621679163382"><span class="hs-identifier hs-var hs-var">minCx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163374"><span class="hs-identifier hs-var">minC</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164308"><span class="hs-identifier hs-var">_gcMinScaleX</span></a></span><span>
</span><span id="line-417"></span><span>        </span><span id="local-6989586621679163381"><span class="annot"><span class="annottext">maxCx :: Double
</span><a href="#local-6989586621679163381"><span class="hs-identifier hs-var hs-var">maxCx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163388"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164307"><span class="hs-identifier hs-var">_gcMaxScaleX</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span id="local-6989586621679163378"><span class="annot"><span class="annottext">minCy :: Double
</span><a href="#local-6989586621679163378"><span class="hs-identifier hs-var hs-var">minCy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163374"><span class="hs-identifier hs-var">minC</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164306"><span class="hs-identifier hs-var">_gcMinScaleY</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span id="local-6989586621679163377"><span class="annot"><span class="annottext">maxCy :: Double
</span><a href="#local-6989586621679163377"><span class="hs-identifier hs-var hs-var">maxCy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163387"><span class="hs-identifier hs-var">cy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164305"><span class="hs-identifier hs-var">_gcMaxScaleY</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span id="local-6989586621679163374"><span class="annot"><span class="annottext">minC :: Double
</span><a href="#local-6989586621679163374"><span class="hs-identifier hs-var hs-var">minC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163390"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163413"><span class="hs-identifier hs-var">maxX</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163412"><span class="hs-identifier hs-var">minX</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163389"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">64</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163394"><span class="hs-identifier hs-var">maxY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163396"><span class="hs-identifier hs-var">minY</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621679163412"><span class="annot"><span class="annottext">minX :: Double
</span><a href="#local-6989586621679163412"><span class="hs-identifier hs-var hs-var">minX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">999</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164312"><span class="hs-identifier hs-var">_gcMinX</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679163413"><span class="annot"><span class="annottext">maxX :: Double
</span><a href="#local-6989586621679163413"><span class="hs-identifier hs-var hs-var">maxX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">999</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164311"><span class="hs-identifier hs-var">_gcMaxX</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span id="local-6989586621679163396"><span class="annot"><span class="annottext">minY :: Double
</span><a href="#local-6989586621679163396"><span class="hs-identifier hs-var hs-var">minY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">999</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164310"><span class="hs-identifier hs-var">_gcMinY</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621679163394"><span class="annot"><span class="annottext">maxY :: Double
</span><a href="#local-6989586621679163394"><span class="hs-identifier hs-var hs-var">maxY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">999</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679164309"><span class="hs-identifier hs-var">_gcMaxY</span></a></span><span>
</span><span id="line-426"></span></pre></body></html>